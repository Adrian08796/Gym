# vite.config.js

```js
// vite.config.js

import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [react()],
  server: {
    host: true,
    port: 5173,
  },
  resolve: {
    alias: {
      '@': '/src',
    },
  },
});
```

# tailwind.config.js

```js
// tailwind.config.js

/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  darkMode: 'class',
  theme: {
    extend: {
      colors: {
        'primary': '#3490dc',
        'secondary': '#ffed4a',
        'accent': '#f6993f',
        'background': {
          light: '#f8fafc',
          dark: '#1a202c',
        },
        'text': {
          light: '#2d3748',
          dark: '#e2e8f0',
        },
      },
      fontFamily: {
        'sans': ['Roboto', 'Arial', 'sans-serif'],
        'heading': ['Montserrat', 'Helvetica', 'sans-serif'],
      },
    },
  },
  plugins: [],
}
```

# postcss.config.js

```js
export default {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}

```

# package.json

```json
{
  "name": "gym-app",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite --host='192.168.178.42' --open",
    "build": "vite build",
    "lint": "eslint . --ext js,jsx --report-unused-disable-directives --max-warnings 0",
    "start": "serve -s dist",
    "preview": "serve -s dist"
  },
  "dependencies": {
    "axios": "^1.7.3",
    "date-fns": "^3.6.0",
    "react": "^18.3.1",
    "react-big-calendar": "^1.13.2",
    "react-dom": "^18.3.1",
    "react-icons": "^5.3.0",
    "react-router-dom": "^6.25.1",
    "react-transition-group": "^4.4.5",
    "recharts": "^2.13.0-alpha.4",
    "serve": "^14.2.3"
  },
  "devDependencies": {
    "@types/react": "^18.3.3",
    "@types/react-dom": "^18.3.0",
    "@vitejs/plugin-react": "^4.3.1",
    "autoprefixer": "^10.4.19",
    "eslint": "^8.57.0",
    "eslint-plugin-react": "^7.34.3",
    "eslint-plugin-react-hooks": "^4.6.2",
    "eslint-plugin-react-refresh": "^0.4.7",
    "postcss": "^8.4.40",
    "tailwindcss": "^3.4.7",
    "vite": "^5.3.4"
  }
}

```

# index.html

```html
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite + React</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>

```

# README.md

```md
# React + Vite

This template provides a minimal setup to get React working in Vite with HMR and some ESLint rules.

Currently, two official plugins are available:

- [@vitejs/plugin-react](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react/README.md) uses [Babel](https://babeljs.io/) for Fast Refresh
- [@vitejs/plugin-react-swc](https://github.com/vitejs/vite-plugin-react-swc) uses [SWC](https://swc.rs/) for Fast Refresh

```

# .gitignore

```
# Node.js
node_modules/
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# Logs
logs/
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# Runtime data
pids/
*.pid
*.seed
*.pid.lock

# Directory for instrumented libs generated by jscoverage/JSCover
lib-cov/

# Coverage directory used by tools like istanbul
coverage/
*.lcov

# nyc test coverage
.nyc_output/

# Grunt intermediate storage (http://gruntjs.com/creating-plugins#storing-task-files)
.grunt/

# Bower dependency directory (https://bower.io/)
bower_components/

# TypeScript
*.tsbuildinfo

# Optional npm cache directory
.npm

# Optional eslint cache
.eslintcache

# Optional stylelint cache
.stylelintcache

# dotenv environment variables file
.env
.env.test
.env.development
.env.production
.env.staging

# parcel-bundler cache (https://parceljs.org/)
.cache
.parcel-cache

# Next.js build output
.next
out/

# Nuxt.js build / generate output
.nuxt
dist/

# Gatsby files
.cache/
# Comment in the public line in if your project uses Gatsby and not Next.js
# public

# vuepress build output
.vuepress/dist

# Serverless directories
.serverless/

# FuseBox cache
.fusebox/

# DynamoDB Local files
.dynamodb/

# TernJS port file
.tern-port

# Storybook
out/
.storybook-out/

# Mac system files
.DS_Store

# Windows system files
Thumbs.db
ehthumbs.db

# JetBrains IDEs
.idea/

# VS Code
.vscode/

# npm
package-lock.json
yarn.lock

# IDE specific files
*.swp
*.swo
*~
*.sublime-project
*.sublime-workspace

# Temporary files
tmp/
temp/

# Build directories
build/
dist/

# Static files
public/static/

# Test coverage
coverage/

# Compiled output
lib/
target/

# Dependency directories
jspm_packages/

# Python virtualenv
venv/
.venv/

# Miscellaneous
*.bak
*.old
*.orig
*.merged

# Local git configuration

```

# .eslintrc.cjs

```cjs
module.exports = {
  root: true,
  env: { browser: true, es2020: true },
  extends: [
    'eslint:recommended',
    'plugin:react/recommended',
    'plugin:react/jsx-runtime',
    'plugin:react-hooks/recommended',
  ],
  ignorePatterns: ['dist', '.eslintrc.cjs'],
  parserOptions: { ecmaVersion: 'latest', sourceType: 'module' },
  settings: { react: { version: '18.2' } },
  plugins: ['react-refresh'],
  rules: {
    'react/jsx-no-target-blank': 'off',
    'react-refresh/only-export-components': [
      'warn',
      { allowConstantExport: true },
    ],
  },
}

```

# .aidigestignore

```
node_modules/
public/
```

# src/main.jsx

```jsx
import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App.jsx'
import './index.css'

ReactDOM.createRoot(document.getElementById('root')).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>,
)

```

# src/index.css

```css
@tailwind base;
@tailwind components;
@tailwind utilities;


```

# src/App.jsx

```jsx
// src/App.jsx

import { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';
import Home from './pages/Home';
import WorkoutTracker from './pages/WorkoutTracker';
import ExerciseLibrary from './pages/ExerciseLibrary';
import WorkoutPlans from './pages/WorkoutPlans';
import WorkoutSummary from './pages/WorkoutSummary';
import IndividualWorkoutSummary from './components/IndividualWorkoutSummary';
import WorkoutPlanDetails from './components/WorkoutPlanDetails';
import Header from './components/Header';
import Footer from './components/Footer';
import Login from './components/Login';
import Register from './components/Register';
import Dashboard from './components/Dashboard';
import { AuthProvider, useAuth } from './context/AuthContext';
import { GymProvider } from './context/GymContext';
import { NotificationProvider } from './context/NotificationContext';
import { ThemeProvider, useTheme } from './context/ThemeContext';
import NotificationToast from './components/NotificationToast';

const PrivateRoute = ({ children }) => {
  const { user, loading } = useAuth();
  if (loading) {
    return <div>Loading...</div>;
  }
  return user ? children : <Navigate to="/login" />;
};

function AppContent() {
  const { user, loading } = useAuth();
  const { darkMode } = useTheme();

  if (loading) {
    return <div>Loading...</div>;
  }

  return (
    <Router>
      <div className={`App min-h-screen flex flex-col ${darkMode ? 'dark' : ''}`}>
        <Header />
        <main className="flex-grow bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100">
          <div className="container mx-auto px-4 py-8">
            <Routes>
              <Route path="/login" element={user ? <Navigate to="/" /> : <Login />} />
              <Route path="/register" element={user ? <Navigate to="/" /> : <Register />} />
              <Route path="/" element={<PrivateRoute><Home /></PrivateRoute>} />
              <Route path="/dashboard" element={<PrivateRoute><Dashboard /></PrivateRoute>} />
              <Route path="/tracker" element={<PrivateRoute><WorkoutTracker /></PrivateRoute>} />
              <Route path="/exercises" element={<PrivateRoute><ExerciseLibrary /></PrivateRoute>} />
              <Route path="/plans" element={<PrivateRoute><WorkoutPlans /></PrivateRoute>} />
              <Route path="/plans/:id" element={<PrivateRoute><WorkoutPlanDetails /></PrivateRoute>} />
              <Route path="/workout-summary" element={<PrivateRoute><WorkoutSummary /></PrivateRoute>} />
              <Route path="/workout-summary/:id" element={<PrivateRoute><IndividualWorkoutSummary /></PrivateRoute>} />
            </Routes>
          </div>
        </main>
        <Footer />
        <NotificationToast />
      </div>
    </Router>
  );
}

function App() {
  return (
    <AuthProvider>
      <NotificationProvider>
        <GymProvider>
          <ThemeProvider>
            <AppContent />
          </ThemeProvider>
        </GymProvider>
      </NotificationProvider>
    </AuthProvider>
  );
}

export default App;
```

# src/App.css

```css
#root {
  max-width: 1280px;
  margin: 0 auto;
  padding: 2rem;
  text-align: center;
}

.logo {
  height: 6em;
  padding: 1.5em;
  will-change: filter;
  transition: filter 300ms;
}
.logo:hover {
  filter: drop-shadow(0 0 2em #646cffaa);
}
.logo.react:hover {
  filter: drop-shadow(0 0 2em #61dafbaa);
}

@keyframes logo-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: no-preference) {
  a:nth-of-type(2) .logo {
    animation: logo-spin infinite 20s linear;
  }
}

.card {
  padding: 2em;
}

.read-the-docs {
  color: #888;
}

```

# src/pages/WorkoutTracker.jsx

```jsx
// src/pages/WorkoutTracker.jsx

import React, { useState, useEffect, useRef, useCallback } from 'react';
import { useNavigate } from 'react-router-dom';
import { useGymContext } from '../context/GymContext';
import { useNotification } from '../context/NotificationContext';
import { useTheme } from '../context/ThemeContext';
import { CSSTransition, TransitionGroup } from 'react-transition-group';
import './WorkoutTracker.css';

function WorkoutTracker() {
  const [currentPlan, setCurrentPlan] = useState(null);
  const [currentExerciseIndex, setCurrentExerciseIndex] = useState(0);
  const [sets, setSets] = useState([]);
  const [startTime, setStartTime] = useState(null);
  const [elapsedTime, setElapsedTime] = useState(0);
  const [weight, setWeight] = useState('');
  const [reps, setReps] = useState('');
  const [restTime, setRestTime] = useState(60);
  const [isResting, setIsResting] = useState(false);
  const [remainingRestTime, setRemainingRestTime] = useState(0);
  const [notes, setNotes] = useState([]);
  const [previousWorkout, setPreviousWorkout] = useState(null);
  const [isPreviousWorkoutLoading, setIsPreviousWorkoutLoading] = useState(false);
  const [totalPauseTime, setTotalPauseTime] = useState(0);
  const [skippedPauses, setSkippedPauses] = useState(0);
  const [progression, setProgression] = useState(0);
  const [lastSetValues, setLastSetValues] = useState({});
  const [requiredSets, setRequiredSets] = useState({});

  const { addWorkout, getLastWorkoutByPlan, workoutHistory } = useGymContext();
  const { addNotification } = useNotification();
  const { darkMode } = useTheme();
  const navigate = useNavigate();
  const nodeRef = useRef(null);

  const loadStoredData = useCallback(() => {
    const storedPlan = localStorage.getItem('currentPlan');
    const storedSets = localStorage.getItem('currentSets');
    const storedIndex = localStorage.getItem('currentExerciseIndex');
    const storedStartTime = localStorage.getItem('workoutStartTime');
    const storedNotes = localStorage.getItem('workoutNotes');
    const storedLastSetValues = localStorage.getItem('lastSetValues');

    if (storedPlan) {
      try {
        const parsedPlan = JSON.parse(storedPlan);
        setCurrentPlan(parsedPlan);
        
        // Initialize requiredSets based on the plan
        const initialRequiredSets = {};
        parsedPlan.exercises.forEach(exercise => {
          initialRequiredSets[exercise._id] = exercise.requiredSets || 3; // Default to 3 if not specified
        });
        setRequiredSets(initialRequiredSets);

        if (storedSets) {
          setSets(JSON.parse(storedSets));
        } else {
          setSets(parsedPlan.exercises.map(() => []));
        }
        
        if (storedIndex !== null) {
          setCurrentExerciseIndex(parseInt(storedIndex, 10));
        }

        if (storedStartTime) {
          setStartTime(new Date(storedStartTime));
        } else {
          const newStartTime = new Date();
          setStartTime(newStartTime);
          localStorage.setItem('workoutStartTime', newStartTime.toISOString());
        }

        if (storedNotes) {
          setNotes(JSON.parse(storedNotes));
        } else {
          setNotes(parsedPlan.exercises.map(() => ''));
        }

        if (storedLastSetValues) {
          setLastSetValues(JSON.parse(storedLastSetValues));
        }
      } catch (error) {
        console.error('Error parsing stored data:', error);
        clearLocalStorage();
        addNotification('Error loading workout data. Starting a new workout.', 'error');
      }
    }
  }, [addNotification]);

  useEffect(() => {
    loadStoredData();
  }, [loadStoredData]);

  useEffect(() => {
    if (currentPlan) {
      const fetchPreviousWorkout = async () => {
        setIsPreviousWorkoutLoading(true);
        try {
          let lastWorkout;
          if (currentPlan._id) {
            lastWorkout = await getLastWorkoutByPlan(currentPlan._id);
          }
          if (!lastWorkout) {
            lastWorkout = workoutHistory.find(workout => 
              workout.exercises.some(ex => 
                currentPlan.exercises.some(planEx => 
                  planEx._id === ex.exercise._id
                )
              )
            );
          }
          setPreviousWorkout(lastWorkout);
        } catch (error) {
          console.error('Error fetching previous workout:', error);
        } finally {
          setIsPreviousWorkoutLoading(false);
        }
      };
      fetchPreviousWorkout();
    } else {
      setPreviousWorkout(null);
      setIsPreviousWorkoutLoading(false);
    }
  }, [currentPlan, getLastWorkoutByPlan, workoutHistory]);

  useEffect(() => {
    const saveDataToLocalStorage = () => {
      if (currentPlan) {
        localStorage.setItem('currentPlan', JSON.stringify(currentPlan));
      }
      if (sets.length > 0) {
        localStorage.setItem('currentSets', JSON.stringify(sets));
      }
      localStorage.setItem('currentExerciseIndex', currentExerciseIndex.toString());
      localStorage.setItem('workoutNotes', JSON.stringify(notes));
      localStorage.setItem('lastSetValues', JSON.stringify(lastSetValues));
    };

    saveDataToLocalStorage();
  }, [currentPlan, sets, currentExerciseIndex, notes, lastSetValues]);

  useEffect(() => {
    let timer;
    if (startTime) {
      timer = setInterval(() => {
        setElapsedTime(prevTime => prevTime + 1);
      }, 1000);
    }
    return () => clearInterval(timer);
  }, [startTime]);

  useEffect(() => {
    let restTimer;
    if (isResting && remainingRestTime > 0) {
      restTimer = setInterval(() => {
        setRemainingRestTime(prevTime => prevTime - 1);
      }, 1000);
    } else if (remainingRestTime === 0 && isResting) {
      setIsResting(false);
      addNotification('Rest time is over. Ready for the next set!', 'info');
    }
    return () => clearInterval(restTimer);
  }, [isResting, remainingRestTime, addNotification]);

  const handleSetComplete = () => {
    if (!weight || !reps) {
      addNotification('Please enter both weight and reps', 'error');
      return;
    }

    setSets(prevSets => {
      const newSets = [...prevSets];
      newSets[currentExerciseIndex] = [
        ...(newSets[currentExerciseIndex] || []),
        { 
          weight: Number(weight), 
          reps: Number(reps), 
          completedAt: new Date().toISOString(),
          skippedRest: isResting
        }
      ];
      return newSets;
    });

    // Store the last set values for the current exercise only
    setLastSetValues(prev => ({
      ...prev,
      [currentPlan.exercises[currentExerciseIndex]._id]: { weight, reps }
    }));

    addNotification('Set completed!', 'success');

    // Always start a new rest timer after completing a set
    startRestTimer();

    updateProgression();
  };

  const startRestTimer = () => {
    setIsResting(true);
    setRemainingRestTime(restTime);
  };

  const skipRestTimer = () => {
    setIsResting(false);
    setRemainingRestTime(0);
    setSkippedPauses(prevSkipped => prevSkipped + 1);
    addNotification('Rest timer skipped', 'info');
  };

  const updateProgression = () => {
    const totalExercises = currentPlan.exercises.length;
    const completedExercises = currentPlan.exercises.filter((exercise, index) => 
      isExerciseComplete(exercise._id, sets[index] || [])
    ).length;
    const newProgression = (completedExercises / totalExercises) * 100;
    setProgression(newProgression);
  };

  const handleFinishWorkout = async () => {
    const endTime = new Date();
    const completedWorkout = {
      plan: currentPlan._id,
      planName: currentPlan.name,
      exercises: currentPlan.exercises.map((exercise, index) => ({
        exercise: exercise._id,
        sets: sets[index] || [],
        completedAt: sets[index] && sets[index].length > 0 
          ? sets[index][sets[index].length - 1].completedAt 
          : endTime.toISOString(),
        notes: notes[index]
      })),
      startTime: startTime.toISOString(),
      endTime: endTime.toISOString(),
      totalPauseTime,
      skippedPauses,
      progression
    };
    
    try {
      await addWorkout(completedWorkout);
      addNotification('Workout completed and saved!', 'success');
      clearLocalStorage();
      navigate('/');
    } catch (error) {
      console.error('Error saving workout:', error);
      addNotification('Failed to save workout. Please try again.', 'error');
    }
  };

  const handleCancelWorkout = () => {
    if (window.confirm("Are you sure you want to cancel this workout? All progress will be lost.")) {
      clearLocalStorage();
      setCurrentPlan(null);
      setSets([]);
      setNotes([]);
      setStartTime(null);
      setElapsedTime(0);
      setLastSetValues({});
      addNotification('Workout cancelled', 'info');
    }
  };

  const clearLocalStorage = () => {
    localStorage.removeItem('currentPlan');
    localStorage.removeItem('currentSets');
    localStorage.removeItem('currentExerciseIndex');
    localStorage.removeItem('workoutStartTime');
    localStorage.removeItem('workoutNotes');
    localStorage.removeItem('lastSetValues');
  };

  const formatTime = (seconds) => {
    const hours = Math.floor(seconds / 3600);
    const minutes = Math.floor((seconds % 3600) / 60);
    const remainingSeconds = seconds % 60;
    return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
  };

  const isExerciseComplete = (exerciseId, exerciseSets) => {
    return exerciseSets.length >= requiredSets[exerciseId];
  };

  const calculateProgress = () => {
    if (!currentPlan) return 0;
    const totalExercises = currentPlan.exercises.length;
    const completedExercises = currentPlan.exercises.filter((exercise, index) => 
      isExerciseComplete(exercise._id, sets[index] || [])
    ).length;
    return (completedExercises / totalExercises) * 100;
  };

  const handleNoteChange = (index, value) => {
    setNotes(prevNotes => {
      const newNotes = [...prevNotes];
      newNotes[index] = value;
      return newNotes;
    });
  };

  const handleExerciseChange = (newIndex) => {
    setCurrentExerciseIndex(newIndex);
    
    const newExercise = currentPlan.exercises[newIndex];
    const lastValues = lastSetValues[newExercise._id];
    if (lastValues) {
      setWeight(lastValues.weight);
      setReps(lastValues.reps);
    } else {
      setWeight('');
      setReps('');
    }
  };

  if (!currentPlan) {
    return (
      <div className={`container mx-auto mt-8 p-4 ${darkMode ? 'bg-gray-800 text-white' : 'bg-white text-gray-800'}`}>
        <h2 className="text-3xl font-bold mb-4">Workout Tracker</h2>
        <p className="text-xl mb-4">No active workout</p>
        <p className="mb-4">To start a new workout, please select a workout plan from the Workout Plans page.</p>
        <button
          onClick={() => navigate('/plans')}
          className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
        >
          Go to Workout Plans
        </button>
      </div>
    );
  }

  const currentExercise = currentPlan.exercises[currentExerciseIndex];

  return (
    <div className={`container mx-auto mt-8 p-4 ${darkMode ? 'bg-gray-800 text-white' : 'bg-white text-gray-800'}`}>
      <h2 className="text-3xl font-bold mb-4">Workout Tracker</h2>
      <h3 className="text-xl mb-4">{currentPlan.name}</h3>
      
      <div className="mb-4 text-lg">
        Elapsed Time: {formatTime(elapsedTime)}
      </div>

      <div className="mb-4">
        <div className="w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700">
          <div className="bg-blue-600 h-2.5 rounded-full" style={{width: `${calculateProgress()}%`}}></div>
        </div>
        <p className="text-sm mt-2">Overall Progress: {calculateProgress().toFixed(2)}%</p>
      </div>

      <div className="mb-4 flex flex-wrap justify-between items-center">
        <div className="flex flex-wrap">
          {currentPlan.exercises.map((exercise, index) => (
            <button
              key={exercise._id}
              onClick={() => handleExerciseChange(index)}
              className={`mr-2 mb-2 px-3 py-1 rounded ${
                index === currentExerciseIndex
                  ? 'bg-blue-500 text-white'
                  : isExerciseComplete(exercise._id, sets[index] || [])
                  ? 'bg-green-500 text-white'
                  : 'bg-gray-300 text-gray-800'
              }`}
            >
              {exercise.name}
            </button>
          ))}
        </div>
        <button
          onClick={handleCancelWorkout}
          className="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
        >
          Cancel Workout
        </button>
      </div>
      
      <TransitionGroup>
        <CSSTransition
          key={currentExerciseIndex}
          nodeRef={nodeRef}
          timeout={300}
          classNames="fade"
        >
          <div ref={nodeRef} className={`bg-gray-100 dark:bg-gray-700 shadow-md rounded px-8 pt-6 pb-8 mb-4 ${darkMode ? 'text-white' : 'text-gray-800'}`}>
            <h4 className="text-lg font-semibold mb-2">Current Exercise: {currentExercise.name}</h4>
            <p className="text-sm text-gray-600 dark:text-gray-300 mb-2">Exercise {currentExerciseIndex + 1} of {currentPlan.exercises.length}</p>
            <div className="flex flex-col md:flex-row mb-4">
              <img 
                src={currentExercise.imageUrl} 
                alt={currentExercise.name} 
                className="w-full md:w-1/3 h-48 object-cover rounded-lg mr-0 md:mr-4 mb-4 md:mb-0"
              />
              <div>
                <p className="mb-2"><strong>Description:</strong> {currentExercise.description}</p>
                <p className="mb-2"><strong>Target Muscle:</strong> {currentExercise.target}</p>
                <p className="mb-2">
                  <strong>Sets completed:</strong> {(sets[currentExerciseIndex] || []).length} / {requiredSets[currentExercise._id]}
                </p>
              </div>
            </div>
            <div className="mb-4 flex">
              <input
                type="number"
                placeholder="Weight (kg)"
                value={weight}
                onChange={(e) => setWeight(e.target.value)}
                className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mr-2"
              />
              <input
                type="number"
                placeholder="Reps"
                value={reps}
                onChange={(e) => setReps(e.target.value)}
                className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              />
            </div>
            <button
              onClick={handleSetComplete}
              className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline mb-4"
            >
              Complete Set
            </button>
            {isResting && (
              <div className="mb-4">
                <p>Rest Time Remaining: {formatTime(remainingRestTime)}</p>
                <div className="w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700">
                  <div 
                    className="bg-green-600 h-2.5 rounded-full" 
                    style={{width: `${(remainingRestTime / restTime) * 100}%`}}
                  ></div>
                </div>
                <button
                  onClick={skipRestTimer}
                  className="mt-2 bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-1 px-2 rounded focus:outline-none focus:shadow-outline"
                >
                  Skip Rest
                </button>
              </div>
            )}
            <div className="mb-4">
              <label className="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2" htmlFor="restTime">
                Rest Time (seconds):
              </label>
              <input
                type="number"
                id="restTime"
                value={restTime}
                onChange={(e) => setRestTime(Number(e.target.value))}
                className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              />
            </div>
            <div className="mb-4">
              <label className="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2" htmlFor={`notes-${currentExerciseIndex}`}>
                Exercise Notes:
              </label>
              <textarea
                id={`notes-${currentExerciseIndex}`}
                value={notes[currentExerciseIndex] || ''}
                onChange={(e) => handleNoteChange(currentExerciseIndex, e.target.value)}
                className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                rows="3"
              ></textarea>
            </div>
          </div>
        </CSSTransition>
      </TransitionGroup>

      <div className="flex justify-between">
        <button
          onClick={() => handleExerciseChange(Math.max(0, currentExerciseIndex - 1))}
          className="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline mb-4"
        >
          Previous Exercise
        </button>
        {currentExerciseIndex < currentPlan.exercises.length - 1 ? (
          <button
            onClick={() => handleExerciseChange(currentExerciseIndex + 1)}
            className="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline mb-4"
          >
            Next Exercise
          </button>
        ) : (
          <button
            onClick={handleFinishWorkout}
            className="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline mb-4"
          >
            Finish Workout
          </button>
        )}
      </div>

      {/* Previous Workout Section */}
      <div className={`mt-8 p-4 rounded-lg ${darkMode ? 'bg-gray-700' : 'bg-blue-100'}`}>
        <h3 className={`text-xl font-semibold mb-4 ${darkMode ? 'text-blue-300' : 'text-blue-800'}`}>Previous Workout Performance</h3>
        {isPreviousWorkoutLoading ? (
          <p>Loading previous workout data...</p>
        ) : previousWorkout ? (
          <div>
            <p><strong>Date:</strong> {new Date(previousWorkout.startTime).toLocaleDateString()}</p>
            <p><strong>Duration:</strong> {formatTime((new Date(previousWorkout.endTime) - new Date(previousWorkout.startTime)) / 1000)}</p>
            {previousWorkout.exercises.map((exercise, index) => (
              <div key={index} className="mb-4">
                <h4 className={`text-lg font-medium ${darkMode ? 'text-blue-200' : 'text-blue-700'}`}>
                  {exercise.exercise ? exercise.exercise.name : 'Unknown Exercise'}
                </h4>
                <ul className="list-disc pl-5">
                  {exercise.sets.map((set, setIndex) => (
                    <li key={setIndex}>
                      Set {setIndex + 1}: {set.weight} kg x {set.reps} reps
                    </li>
                  ))}
                </ul>
                {exercise.notes && (
                  <p className="mt-2 italic">Notes: {exercise.notes}</p>
                )}
              </div>
            ))}
          </div>
        ) : (
          <p>No previous workout data available for this plan.</p>
        )}
      </div>

      {/* Set Log */}
      <div className={`mt-8 p-4 rounded-lg ${darkMode ? 'bg-gray-700' : 'bg-green-100'}`}>
        <h3 className={`text-xl font-semibold mb-4 ${darkMode ? 'text-green-300' : 'text-green-800'}`}>Current Workout Set Log</h3>
        {currentPlan.exercises.map((exercise, index) => (
          <div key={exercise._id} className="mb-4">
            <h4 className={`text-lg font-medium ${darkMode ? 'text-green-200' : 'text-green-700'}`}>
              {exercise.name}
              {isExerciseComplete(exercise._id, sets[index] || []) && ' (Complete)'}
            </h4>
            {sets[index] && sets[index].length > 0 ? (
              <ul className="list-disc pl-5">
                {sets[index].map((set, setIndex) => (
                  <li key={setIndex}>
                    Set {setIndex + 1}: {set.weight} kg x {set.reps} reps
                  </li>
                ))}
              </ul>
            ) : (
              <p>No sets completed yet</p>
            )}
            <p>
              {sets[index] ? sets[index].length : 0} / {requiredSets[exercise._id]} sets completed
            </p>
            {notes[index] && (
              <p className="mt-2 italic">Notes: {notes[index]}</p>
            )}
          </div>
        ))}
      </div>
    </div>
  );
}

export default WorkoutTracker;
```

# src/pages/WorkoutTracker.css

```css
/* src/pages/WorkoutTracker.css */

.fade-enter {
    opacity: 0;
    transform: translateY(20px);
  }
  
  .fade-enter-active {
    opacity: 1;
    transform: translateY(0);
    transition: opacity 300ms, transform 300ms;
  }
  
  .fade-exit {
    opacity: 1;
  }
  
  .fade-exit-active {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 300ms, transform 300ms;
  }
```

# src/pages/WorkoutSummary.jsx

```jsx
// src/pages/WorkoutSummary.jsx

import React, { useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import { useGymContext } from '../context/GymContext';
import { useAuth } from '../context/AuthContext';
import { useTheme } from '../context/ThemeContext';

function WorkoutSummary() {
  const { workoutHistory, fetchWorkoutHistory } = useGymContext();
  const { user } = useAuth();
  const { darkMode } = useTheme();
  const navigate = useNavigate();

  useEffect(() => {
    if (user) {
      fetchWorkoutHistory();
    }
  }, [user, fetchWorkoutHistory]);

  const formatDuration = (start, end) => {
    if (!start || !end) return 'N/A';
    const duration = new Date(end) - new Date(start);
    const hours = Math.floor(duration / 3600000);
    const minutes = Math.floor((duration % 3600000) / 60000);
    return `${hours}h ${minutes}m`;
  };

  const formatTime = (dateString) => {
    if (!dateString) return 'N/A';
    return new Date(dateString).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
  };

  const formatDate = (dateString) => {
    if (!dateString) return 'N/A';
    return new Date(dateString).toLocaleDateString();
  };

  if (!user) {
    return <div className="container mx-auto mt-8">Please log in to view your workout history.</div>;
  }

  if (workoutHistory.length === 0) {
    return <div className="container mx-auto mt-8">No workout history available.</div>;
  }

  return (
    <div className={`container mx-auto mt-8 ${darkMode ? 'bg-gray-900 text-gray-100' : 'bg-gray-100 text-gray-900'}`}>
      <h2 className="text-2xl font-bold mb-4">Workout History</h2>
      {workoutHistory.map((workout) => (
        <div key={workout._id} className={`mb-8 p-4 border rounded shadow ${darkMode ? 'bg-gray-800 border-gray-700' : 'bg-white border-gray-300'}`}>
          <h3 className="text-xl mb-2">
            {workout.planName} {workout.planDeleted && <span className="text-red-500">(Deleted)</span>}
          </h3>
          <p className="mb-2">Date: {formatDate(workout.date || workout.startTime)}</p>
          <p className="mb-2">Start Time: {formatTime(workout.startTime)}</p>
          <p className="mb-2">End Time: {formatTime(workout.endTime)}</p>
          <p className="mb-2">Duration: {formatDuration(workout.startTime, workout.endTime)}</p>
          <p className="mb-2">Progression: {workout.progression ? `${workout.progression.toFixed(2)}%` : 'N/A'}</p>
          <p className="mb-4">Total Pause Time: {workout.totalPauseTime ? `${workout.totalPauseTime} seconds` : 'N/A'}</p>

          {workout.exercises.map((exercise, index) => (
            <div key={index} className={`mb-4 p-3 rounded ${darkMode ? 'bg-gray-700' : 'bg-gray-100'}`}>
              <h4 className={`text-lg font-medium ${darkMode ? 'text-gray-200' : 'text-gray-800'}`}>
                {exercise.exercise ? exercise.exercise.name : 'Deleted Exercise'}
              </h4>
              {exercise.completedAt && (
                <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Completed at: {formatTime(exercise.completedAt)}</p>
              )}
              {exercise.sets && exercise.sets.length > 0 ? (
                <ul className="list-disc pl-5 mt-2">
                  {exercise.sets.map((set, setIndex) => (
                    <li key={setIndex} className={`mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                      Set {setIndex + 1}: {set.weight} lbs x {set.reps} reps
                      {set.completedAt && (
                        <span className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'} ml-2`}>
                          (at {formatTime(set.completedAt)})
                        </span>
                      )}
                      {set.skippedRest && (
                        <span className="text-yellow-500 ml-2">(Rest Skipped)</span>
                      )}
                    </li>
                  ))}
                </ul>
              ) : (
                <p className={`mt-2 italic ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>No sets completed</p>
              )}
              {exercise.notes && (
                <p className={`mt-2 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                  <strong>Notes:</strong> {exercise.notes}
                </p>
              )}
            </div>
          ))}
        </div>
      ))}
      <button
        onClick={() => navigate('/')}
        className={`bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline mt-4`}
      >
        Back to Home
      </button>
    </div>
  );
}

export default WorkoutSummary;
```

# src/pages/WorkoutPlans.jsx

```jsx
// src/pages/WorkoutPlans.jsx

import React, { useState, useEffect, useCallback, useMemo } from 'react';
import { useNavigate } from 'react-router-dom';
import { Calendar, momentLocalizer } from 'react-big-calendar';
import withDragAndDrop from 'react-big-calendar/lib/addons/dragAndDrop';
import moment from 'moment';
import 'react-big-calendar/lib/css/react-big-calendar.css';
import 'react-big-calendar/lib/addons/dragAndDrop/styles.css';
import { useGymContext } from '../context/GymContext';
import { useNotification } from '../context/NotificationContext';
import { useTheme } from '../context/ThemeContext';
import WorkoutPlanForm from '../components/WorkoutPlanForm';
import WorkoutPlanCard from '../components/WorkoutPlanCard';
import WorkoutPlanModal from '../components/WorkoutPlanModal';

const localizer = momentLocalizer(moment);
const DnDCalendar = withDragAndDrop(Calendar);

const workoutColors = {
  strength: '#4CAF50',
  cardio: '#2196F3',
  flexibility: '#FF9800',
  default: '#9C27B0',
  completed: '#607D8B'
};

function WorkoutPlans() {
  const { 
    workoutPlans, 
    workoutHistory, 
    deleteWorkoutPlan, 
    addWorkoutPlan, 
    updateWorkoutPlan, 
    fetchWorkoutPlans
  } = useGymContext();
  const [showForm, setShowForm] = useState(false);
  const [editingPlan, setEditingPlan] = useState(null);
  const [ongoingWorkout, setOngoingWorkout] = useState(null);
  const [viewMode, setViewMode] = useState('grid');
  const [searchTerm, setSearchTerm] = useState('');
  const [filterType, setFilterType] = useState('all');
  const [selectedPlan, setSelectedPlan] = useState(null);
  const navigate = useNavigate();
  const { addNotification } = useNotification();
  const { darkMode } = useTheme();

  useEffect(() => {
    const storedPlan = localStorage.getItem('currentPlan');
    if (storedPlan) {
      setOngoingWorkout(JSON.parse(storedPlan));
    }
  }, []);

  const handleStartWorkout = (plan) => {
    localStorage.setItem('currentPlan', JSON.stringify(plan));
    navigate('/tracker');
  };

  const handleResumeWorkout = () => {
    navigate('/tracker');
  };

  const handleAddWorkoutPlan = async (plan) => {
    try {
      await addWorkoutPlan(plan);
      handleCancelForm();
      await fetchWorkoutPlans();
      addNotification('Workout plan added successfully', 'success');
    } catch (error) {
      console.error('Error adding workout plan:', error);
      addNotification('Failed to add workout plan', 'error');
    }
  };

  const handleEditWorkoutPlan = async (plan) => {
    try {
      await updateWorkoutPlan(plan._id, plan);
      handleCancelForm();
      await fetchWorkoutPlans();
      addNotification('Workout plan updated successfully', 'success');
    } catch (error) {
      console.error('Error updating workout plan:', error);
      addNotification('Failed to update workout plan', 'error');
    }
  };

  const handleCancelForm = () => {
    setShowForm(false);
    setEditingPlan(null);
  };

  const handleEdit = (plan) => {
    setEditingPlan(plan);
    setShowForm(true);
  };

  const handleDelete = async (planId) => {
    try {
      await deleteWorkoutPlan(planId);
      addNotification('Workout plan deleted successfully', 'success');
      fetchWorkoutPlans(); // Refresh the workout plans after deleting
    } catch (error) {
      console.error('Error deleting workout plan:', error);
      addNotification('Failed to delete workout plan', 'error');
    }
  };

  const filteredPlans = workoutPlans.filter(plan => 
    plan.name.toLowerCase().includes(searchTerm.toLowerCase()) &&
    (filterType === 'all' || plan.type === filterType)
  );

  // Calendar-related functions
  const getEventColor = useCallback((event) => {
    if (event.resource === 'history' || event.resource === 'completed') {
      return workoutColors.completed;
    }
    const plan = filteredPlans.find(p => p._id === event.id);
    return plan && plan.type ? workoutColors[plan.type] : workoutColors.default;
  }, [filteredPlans]);

  const events = useMemo(() => {
    const historyEvents = workoutHistory.map(workout => ({
      id: workout._id,
      title: `${workout.planName} (Completed)`,
      start: new Date(workout.startTime),
      end: new Date(workout.endTime),
      allDay: false,
      resource: 'history'
    }));

    const planEvents = filteredPlans
      .filter(plan => plan.scheduledDate)
      .map(plan => ({
        id: plan._id,
        title: plan.name,
        start: new Date(plan.scheduledDate),
        end: new Date(new Date(plan.scheduledDate).setHours(new Date(plan.scheduledDate).getHours() + 1)),
        allDay: false,
        resource: plan.completed ? 'completed' : 'scheduled'
      }));

    return [...historyEvents, ...planEvents];
  }, [workoutHistory, filteredPlans]);

  const handleSelectEvent = useCallback((event) => {
    if (event.resource === 'history') {
      navigate(`/workout-summary/${event.id}`);
    } else {
      const plan = filteredPlans.find(p => p._id === event.id);
      setSelectedPlan(plan);
    }
  }, [filteredPlans, navigate]);

  const handleSelectSlot = useCallback(({ start }) => {
    const planName = prompt('Enter workout plan name:');
    if (planName) {
      const workoutType = prompt('Enter workout type (strength, cardio, flexibility):');
      const newPlan = {
        name: planName,
        exercises: [],
        scheduledDate: start,
        type: workoutType
      };
      addWorkoutPlan(newPlan);
    }
  }, [addWorkoutPlan]);

  const moveEvent = useCallback(({ event, start, end }) => {
    if (event.resource === 'history' || event.resource === 'completed') {
      addNotification('Cannot reschedule completed workouts', 'error');
      return;
    }

    const updatedPlan = filteredPlans.find(plan => plan._id === event.id);
    if (updatedPlan) {
      updatedPlan.scheduledDate = start;
      updateWorkoutPlan(updatedPlan._id, updatedPlan);
      addNotification('Workout rescheduled successfully', 'success');
    }
  }, [filteredPlans, updateWorkoutPlan, addNotification]);

  const resizeEvent = useCallback(({ event, start, end }) => {
    if (event.resource === 'history' || event.resource === 'completed') {
      addNotification('Cannot modify completed workouts', 'error');
      return;
    }

    const updatedPlan = filteredPlans.find(plan => plan._id === event.id);
    if (updatedPlan) {
      updatedPlan.scheduledDate = start;
      updateWorkoutPlan(updatedPlan._id, updatedPlan);
      addNotification('Workout duration updated successfully', 'success');
    }
  }, [filteredPlans, updateWorkoutPlan, addNotification]);

  const eventPropGetter = useCallback((event) => {
    const backgroundColor = getEventColor(event);
    return {
      style: {
        backgroundColor,
        borderRadius: '5px',
        opacity: event.resource === 'history' || event.resource === 'completed' ? 0.7 : 1,
        color: '#fff',
        border: 'none',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        fontSize: '14px',
        fontWeight: '500',
        cursor: event.resource === 'history' || event.resource === 'completed' ? 'not-allowed' : 'pointer'
      }
    };
  }, [getEventColor]);

  return (
    <div className={`p-4 ${darkMode ? 'bg-gray-800 text-white' : 'bg-gray-100 text-gray-900'}`}>
      <h1 className="text-3xl font-bold mb-4">Workout Plans</h1>
      
      {ongoingWorkout && (
        <div className="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-4" role="alert">
          <p className="font-bold">Ongoing Workout</p>
          <p>You have an unfinished workout: {ongoingWorkout.name}</p>
          <button
            onClick={handleResumeWorkout}
            className="mt-2 bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded"
          >
            Resume Workout
          </button>
        </div>
      )}

<div className="mb-4 flex flex-wrap items-center justify-between">
        <button
          onClick={() => {
            setShowForm(!showForm);
            setEditingPlan(null);
          }}
          className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mb-2 sm:mb-0"
        >
          {showForm ? 'Hide Form' : 'Create New Plan'}
        </button>
        
        <div className="flex items-center space-x-2">
          <input
            type="text"
            placeholder="Search plans..."
            value={searchTerm}
            onChange={(e) => setSearchTerm(e.target.value)}
            className="border rounded py-1 px-2 text-gray-700"
          />
          <select
            value={filterType}
            onChange={(e) => setFilterType(e.target.value)}
            className="border rounded py-1 px-2 text-gray-700"
          >
            <option value="all">All Types</option>
            <option value="strength">Strength</option>
            <option value="cardio">Cardio</option>
            <option value="flexibility">Flexibility</option>
            <option value="other">Other</option>
          </select>
          <button
            onClick={() => setViewMode(viewMode === 'grid' ? 'calendar' : 'grid')}
            className="bg-purple-500 hover:bg-purple-700 text-white font-bold py-1 px-2 rounded"
          >
            {viewMode === 'grid' ? 'Calendar View' : 'Grid View'}
          </button>
        </div>
      </div>

      {showForm && (
        <WorkoutPlanForm
          onSubmit={editingPlan ? handleEditWorkoutPlan : handleAddWorkoutPlan}
          initialPlan={editingPlan}
          onCancel={handleCancelForm}
        />
      )}

      {viewMode === 'grid' ? (
        <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
          {filteredPlans.map((plan) => (
            <WorkoutPlanCard
              key={plan._id}
              plan={plan}
              onStart={handleStartWorkout}
              onEdit={handleEdit}
              onDelete={handleDelete}
            />
          ))}
        </div>
      ) : (
        <div className="h-[600px]">
          <DnDCalendar
            localizer={localizer}
            events={events}
            startAccessor="start"
            endAccessor="end"
            style={{ height: '100%' }}
            onSelectSlot={handleSelectSlot}
            onSelectEvent={handleSelectEvent}
            onEventDrop={moveEvent}
            onEventResize={resizeEvent}
            selectable
            resizable
            eventPropGetter={eventPropGetter}
            draggableAccessor={(event) => event.resource !== 'history' && event.resource !== 'completed'}
            views={['month', 'week', 'day']}
            defaultView="month"
            formats={{
              monthHeaderFormat: (date, culture, localizer) =>
                localizer.format(date, 'MMMM YYYY', culture),
              dayHeaderFormat: (date, culture, localizer) =>
                localizer.format(date, 'dddd, MMMM D', culture),
            }}
            components={{
              toolbar: CustomToolbar,
            }}
          />
        </div>
      )}
      {selectedPlan && (
        <WorkoutPlanModal
          plan={selectedPlan}
          onClose={() => setSelectedPlan(null)}
          onEdit={handleEdit}
          onStart={handleStartWorkout}
        />
      )}
    </div>
  );
}

// Custom toolbar component for the calendar
const CustomToolbar = (toolbar) => {
  const goToBack = () => {
    toolbar.date.setMonth(toolbar.date.getMonth() - 1);
    toolbar.onNavigate('prev');
  };

  const goToNext = () => {
    toolbar.date.setMonth(toolbar.date.getMonth() + 1);
    toolbar.onNavigate('next');
  };

  const goToCurrent = () => {
    const now = new Date();
    toolbar.date.setMonth(now.getMonth());
    toolbar.date.setYear(now.getFullYear());
    toolbar.onNavigate('current');
  };

  const label = () => {
    const date = moment(toolbar.date);
    return (
      <span className="text-lg font-semibold">{date.format('MMMM YYYY')}</span>
    );
  };

  return (
    <div className="flex justify-between items-center mb-4">
      <div>
        <button
          className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mr-2"
          onClick={goToBack}
        >
          &lt;
        </button>
        <button
          className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"
          onClick={goToNext}
        >
          &gt;
        </button>
      </div>
      <div>{label()}</div>
      <button
        className="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded"
        onClick={goToCurrent}
      >
        Today
      </button>
    </div>
  );
};

export default WorkoutPlans;
```

# src/pages/Home.jsx

```jsx
// src/pages/Home.jsx
function Home() {
  return (
    <div className="text-gray-900 dark:text-gray-100">
      <h1 className="text-3xl font-bold text-center my-8">Welcome to Your Gym App</h1>
      <p className="text-center">This is where your fitness journey begins!</p>
    </div>
  );
}

export default Home;
```

# src/pages/ExerciseLibrary.jsx

```jsx
// src/pages/ExerciseLibrary.jsx

import React, { useState, useEffect, useMemo } from 'react';
import ExerciseItem from '../components/ExerciseItem';
import AddExerciseForm from '../components/AddExerciseForm';
import WorkoutPlanSelector from '../components/WorkoutPlanSelector';
import ExerciseModal from '../components/ExerciseModal';
import { useGymContext } from '../context/GymContext';
import { useNotification } from '../context/NotificationContext';
import { useTheme } from '../context/ThemeContext';

const categories = ['Strength', 'Cardio', 'Flexibility'];

const categoryColors = {
  Strength: 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300',
  Cardio: 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300',
  Flexibility: 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300'
};

function ExerciseLibrary() {
  const { exercises, updateExercise, deleteExercise, addExerciseToPlan } = useGymContext();
  const { addNotification } = useNotification();
  const { darkMode } = useTheme();
  const [editingExercise, setEditingExercise] = useState(null);
  const [showWorkoutPlanSelector, setShowWorkoutPlanSelector] = useState(false);
  const [selectedExercise, setSelectedExercise] = useState(null);
  const [exerciseToAddToPlan, setExerciseToAddToPlan] = useState(null);
  const [filterText, setFilterText] = useState('');
  const [selectedCategories, setSelectedCategories] = useState([]);
  const [viewMode, setViewMode] = useState('grid');

  const filteredExercises = useMemo(() => {
    return exercises.filter(exercise => 
      (exercise.name.toLowerCase().includes(filterText.toLowerCase()) ||
       exercise.description.toLowerCase().includes(filterText.toLowerCase()) ||
       (Array.isArray(exercise.target) && exercise.target.some(t => t.toLowerCase().includes(filterText.toLowerCase())))) &&
      (selectedCategories.length === 0 || selectedCategories.includes(exercise.category))
    );
  }, [exercises, filterText, selectedCategories]);

  const handleEdit = (exercise) => {
    setEditingExercise(exercise);
    setSelectedExercise(null);
  };

  const handleDelete = (exercise) => {
    deleteExercise(exercise._id);
    setSelectedExercise(null);
  };

  const handleAddToPlan = (exercise) => {
    setExerciseToAddToPlan(exercise);
    setShowWorkoutPlanSelector(true);
  };

  const handleSave = (savedExercise) => {
    setEditingExercise(null);
    // Optionally, you can refresh the exercise list here
  };

  const handleSelectWorkoutPlan = async (plan) => {
    if (!exerciseToAddToPlan || !exerciseToAddToPlan._id) {
      addNotification('No exercise selected', 'error');
      return;
    }
    
    const result = await addExerciseToPlan(plan._id, exerciseToAddToPlan._id);
    
    if (result.success) {
      addNotification(`Exercise added to ${plan.name}`, 'success');
    } else if (result.alreadyInPlan) {
      // The notification is already handled in the GymContext
    } else {
      // The error notification is already handled in the GymContext
    }
    
    setShowWorkoutPlanSelector(false);
    setExerciseToAddToPlan(null);
  };

  const handleCancelEdit = () => {
    setEditingExercise(null);
  };

  const toggleViewMode = () => {
    setViewMode(viewMode === 'grid' ? 'list' : 'grid');
  };

  const toggleCategory = (category) => {
    setSelectedCategories(prev => 
      prev.includes(category)
        ? prev.filter(c => c !== category)
        : [...prev, category]
    );
  };

  return (
    <div className={`bg-white dark:bg-gray-900 text-gray-900 dark:text-white p-4 lg:p-8`}>
      <h1 className="text-3xl lg:text-4xl font-bold mb-6 lg:mb-8">Exercise Library</h1>
      
      <div className="mb-6 lg:mb-8 flex flex-wrap items-center justify-between gap-4">
        <div className="flex-grow">
          <input
            type="text"
            placeholder="Search exercises..."
            value={filterText}
            onChange={(e) => setFilterText(e.target.value)}
            className="w-full px-4 py-2 lg:py-3 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-800 dark:text-white text-lg"
          />
        </div>
        
        <div className="flex items-center gap-4">
          <button
            onClick={toggleViewMode}
            className="px-4 py-2 lg:py-3 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors duration-200"
          >
            {viewMode === 'grid' ? 'List View' : 'Grid View'}
          </button>
        </div>
      </div>

      <div className="mb-6">
        <h2 className="text-xl font-semibold mb-2">Categories</h2>
        <div className="flex flex-wrap gap-2">
          {categories.map(category => (
            <button
              key={category}
              onClick={() => toggleCategory(category)}
              className={`px-3 py-1 rounded-full text-sm font-semibold ${
                selectedCategories.includes(category)
                  ? categoryColors[category]
                  : 'bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300'
              }`}
            >
              {category}
            </button>
          ))}
        </div>
      </div>
      
      <AddExerciseForm 
        onSave={handleSave} 
        initialExercise={editingExercise}
        onCancel={handleCancelEdit}
      />
      
      <div className={`${viewMode === 'grid' ? 'grid gap-6 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5' : 'space-y-4'}`}>
        {filteredExercises.map((exercise) => (
          <ExerciseItem 
            key={exercise._id} 
            exercise={exercise}
            onClick={() => setSelectedExercise(exercise)}
            onEdit={handleEdit}
            onDelete={handleDelete}
            onAddToPlan={handleAddToPlan}
            viewMode={viewMode}
          />
        ))}
      </div>
      
      {selectedExercise && (
        <ExerciseModal
          exercise={selectedExercise}
          onClose={() => setSelectedExercise(null)}
          onEdit={handleEdit}
          onDelete={handleDelete}
          onAddToPlan={handleAddToPlan}
        />
      )}
      
      {showWorkoutPlanSelector && (
        <WorkoutPlanSelector
          onSelect={handleSelectWorkoutPlan}
          onClose={() => {
            setShowWorkoutPlanSelector(false);
            setExerciseToAddToPlan(null);
          }}
        />
      )}

      <div className="mt-8">
        <h2 className="text-xl font-semibold mb-2">Category Legend</h2>
        <div className="flex flex-wrap gap-4">
          {categories.map(category => (
            <div key={category} className="flex items-center">
              <span className={`w-4 h-4 rounded-full mr-2 ${categoryColors[category]}`}></span>
              <span>{category}</span>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}

export default ExerciseLibrary;
```

# src/context/ThemeContext.jsx

```jsx
// src/context/ThemeContext.jsx

import React, { createContext, useContext, useState, useEffect } from 'react';

const ThemeContext = createContext();

export const useTheme = () => useContext(ThemeContext);

export const ThemeProvider = ({ children }) => {
  const [darkMode, setDarkMode] = useState(false);

  useEffect(() => {
    const isDarkMode = localStorage.getItem('darkMode') === 'true';
    setDarkMode(isDarkMode);
  }, []);

  const toggleDarkMode = () => {
    const newDarkMode = !darkMode;
    setDarkMode(newDarkMode);
    localStorage.setItem('darkMode', newDarkMode);
    if (newDarkMode) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
  };

  return (
    <ThemeContext.Provider value={{ darkMode, toggleDarkMode }}>
      {children}
    </ThemeContext.Provider>
  );
};
```

# src/context/NotificationContext.jsx

```jsx
// src/context/NotificationContext.jsx

import React, { createContext, useContext, useState, useCallback } from 'react';

const NotificationContext = createContext();

export const useNotification = () => useContext(NotificationContext);

export function NotificationProvider({ children }) {
  const [notifications, setNotifications] = useState([]);

  const addNotification = useCallback((message, type = 'info', duration = 5000) => {
    const id = Date.now() + Math.random();
    setNotifications(prev => [...prev, { id, message, type }]);
    setTimeout(() => removeNotification(id), duration);
  }, []);

  const removeNotification = useCallback((id) => {
    setNotifications(prev => prev.filter(notification => notification.id !== id));
  }, []);

  const contextValue = React.useMemo(() => ({
    notifications,
    addNotification,
    removeNotification
  }), [notifications, addNotification, removeNotification]);

  return (
    <NotificationContext.Provider value={contextValue}>
      {children}
    </NotificationContext.Provider>
  );
}
```

# src/context/GymContext.jsx

```jsx
// src/context/GymContext.jsx

import { createContext, useContext, useState, useEffect, useCallback, useMemo } from 'react';
import axios from 'axios';
import { useAuth } from './AuthContext';
import { useNotification } from './NotificationContext';
export const hostName = 'http://192.168.178.42';

const GymContext = createContext();

export function useGymContext() {
  return useContext(GymContext);
}

export function GymProvider({ children }) {
  const [workouts, setWorkouts] = useState([]);
  const [exercises, setExercises] = useState([]);
  const [workoutPlans, setWorkoutPlans] = useState([]);
  const [workoutHistory, setWorkoutHistory] = useState([]);
  const { user } = useAuth();
  const { addNotification } = useNotification();
  
  const API_URL = `${hostName}:4500/api`;

  const getAuthConfig = useCallback(() => {
    const token = localStorage.getItem('token');
    return {
      headers: { 'x-auth-token': token }
    };
  }, []);

  const toTitleCase = (str) => {
    if (typeof str !== 'string') return str;
    return str.replace(
      /\w\S*/g,
      function(txt) {
        return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
      }
    );
  };

  // Fetch workout history
  const fetchWorkoutHistory = useCallback(async () => {
    if (user) {
      try {
        const response = await axios.get(`${API_URL}/workouts/user`, getAuthConfig());
        setWorkoutHistory(response.data);
      } catch (error) {
        console.error('Error fetching workout history:', error);
        addNotification('Failed to fetch workout history', 'error');
      }
    }
  }, [user, addNotification, API_URL, getAuthConfig]);

  // Fetch exercises
  const fetchExercises = useCallback(async () => {
    try {
      const response = await axios.get(`${API_URL}/exercises`, getAuthConfig());
      const formattedExercises = response.data.map(exercise => ({
        ...exercise,
        name: toTitleCase(exercise.name),
        description: toTitleCase(exercise.description),
        target: Array.isArray(exercise.target) 
          ? exercise.target.map(toTitleCase) 
          : toTitleCase(exercise.target)
      }));
      setExercises(formattedExercises);
    } catch (error) {
      console.error('Error fetching exercises:', error);
      addNotification('Failed to fetch exercises', 'error');
    }
  }, [API_URL, getAuthConfig, addNotification]);

  // Fetch workout plans
  const fetchWorkoutPlans = useCallback(async () => {
    if (user) {
      try {
        const response = await axios.get(`${API_URL}/workoutplans`, getAuthConfig());
        const plansWithFullExerciseDetails = await Promise.all(response.data.map(async (plan) => {
          const fullExercises = await Promise.all(plan.exercises.map(async (exercise) => {
            if (!exercise.description || !exercise.imageUrl) {
              const fullExercise = await axios.get(`${API_URL}/exercises/${exercise._id}`, getAuthConfig());
              return fullExercise.data;
            }
            return exercise;
          }));
          return { ...plan, exercises: fullExercises };
        }));
        setWorkoutPlans(plansWithFullExerciseDetails);
        return plansWithFullExerciseDetails;
      } catch (error) {
        console.error('Error fetching workout plans:', error);
        addNotification('Failed to fetch workout plans', 'error');
        return [];
      }
    }
    return [];
  }, [user, API_URL, getAuthConfig, addNotification]);

  useEffect(() => {
    if (user) {
      fetchWorkoutHistory();
      fetchExercises();
      fetchWorkoutPlans();
    }
  }, [user, fetchWorkoutHistory, fetchExercises, fetchWorkoutPlans]);

  // Add a workout (updated to include notes)
  const addWorkout = async (workout) => {
    try {
      console.log('Sending workout data:', JSON.stringify(workout, null, 2));
      const response = await axios.post(`${API_URL}/workouts`, workout, getAuthConfig());
      console.log('Server response:', response.data);
      setWorkoutHistory(prevHistory => [response.data, ...prevHistory]);
      setWorkouts(prevWorkouts => [...prevWorkouts, response.data]);
      addNotification('Workout added successfully', 'success');
    } catch (error) {
      console.error('Error adding workout:', error);
      if (error.response) {
        console.error('Response data:', error.response.data);
        console.error('Response status:', error.response.status);
        console.error('Response headers:', error.response.headers);
      } else if (error.request) {
        console.error('No response received:', error.request);
      } else {
        console.error('Error setting up request:', error.message);
      }
      addNotification('Failed to add workout', 'error');
      throw error;
    }
  };

  // Update a workout
  const updateWorkout = async (id, updatedWorkout) => {
    try {
      const response = await axios.put(`${API_URL}/workouts/${id}`, updatedWorkout, getAuthConfig());
      setWorkouts(prevWorkouts =>
        prevWorkouts.map(workout =>
          workout._id === id ? response.data : workout
        )
      );
      setWorkoutHistory(prevHistory =>
        prevHistory.map(workout =>
          workout._id === id ? response.data : workout
        )
      );
      addNotification('Workout updated successfully', 'success');
      return response.data;
    } catch (error) {
      console.error('Error updating workout:', error);
      addNotification('Failed to update workout', 'error');
      throw error;
    }
  };

  // Delete a workout
  const deleteWorkout = async (id) => {
    try {
      await axios.delete(`${API_URL}/workouts/${id}`, getAuthConfig());
      setWorkouts(prevWorkouts => prevWorkouts.filter(workout => workout._id !== id));
      setWorkoutHistory(prevHistory => prevHistory.filter(workout => workout._id !== id));
      addNotification('Workout deleted successfully', 'success');
    } catch (error) {
      console.error('Error deleting workout:', error);
      addNotification('Failed to delete workout', 'error');
      throw error;
    }
  };

  // Add an exercise
  const addExercise = async (exercise) => {
    try {
      const exerciseWithTitleCase = {
        ...exercise,
        name: toTitleCase(exercise.name),
        description: toTitleCase(exercise.description),
        target: toTitleCase(exercise.target)
      };
      const response = await axios.post(`${API_URL}/exercises`, exerciseWithTitleCase, getAuthConfig());
      setExercises(prevExercises => [...prevExercises, response.data]);
      return response.data;
    } catch (error) {
      console.error('Error adding exercise:', error);
      addNotification('Failed to add exercise', 'error');
      throw error;
    }
  };

  // Update an exercise
  const updateExercise = async (id, updatedExercise) => {
    try {
      const exerciseWithTitleCase = {
        ...updatedExercise,
        name: toTitleCase(updatedExercise.name),
        description: toTitleCase(updatedExercise.description),
        target: toTitleCase(updatedExercise.target)
      };
      const response = await axios.put(`${API_URL}/exercises/${id}`, exerciseWithTitleCase, getAuthConfig());
      setExercises(prevExercises =>
        prevExercises.map(exercise =>
          exercise._id === id ? response.data : exercise
        )
      );
      return response.data;
    } catch (error) {
      console.error('Error updating exercise:', error);
      addNotification('Failed to update exercise', 'error');
      throw error;
    }
  };

  // Delete an exercise
  const deleteExercise = async (id) => {
    try {
      await axios.delete(`${API_URL}/exercises/${id}`, getAuthConfig());
      setExercises(prevExercises => prevExercises.filter(exercise => exercise._id !== id));
      addNotification('Exercise deleted successfully', 'success');
    } catch (error) {
      console.error('Error deleting exercise:', error);
      addNotification('Failed to delete exercise', 'error');
      throw error;
    }
  };

  // Add a workout plan
  const addWorkoutPlan = async (plan) => {
    try {
      const planToSend = {
        ...plan,
        exercises: plan.exercises.map(exercise => 
          typeof exercise === 'string' ? exercise : exercise._id
        )
      };

      const response = await axios.post(`${API_URL}/workoutplans`, planToSend, getAuthConfig());
      
      const fullPlan = {
        ...response.data,
        exercises: await Promise.all(response.data.exercises.map(async (exerciseId) => {
          if (typeof exerciseId === 'string') {
            try {
              const exerciseResponse = await axios.get(`${API_URL}/exercises/${exerciseId}`, getAuthConfig());
              return exerciseResponse.data;
            } catch (error) {
              console.error(`Error fetching exercise ${exerciseId}:`, error);
              return null;
            }
          }
          return exerciseId;
        }))
      };

      setWorkoutPlans(prevPlans => [...prevPlans, fullPlan]);
      addNotification('Workout plan added successfully', 'success');
      return fullPlan;
    } catch (error) {
      console.error('Error adding workout plan:', error);
      addNotification('Failed to add workout plan', 'error');
      throw error;
    }
  };

  // Update a workout plan
  const updateWorkoutPlan = async (id, updatedPlan) => {
    try {
      if (!id) {
        return addWorkoutPlan(updatedPlan);
      }
      const response = await axios.put(`${API_URL}/workoutplans/${id}`, updatedPlan, getAuthConfig());
      setWorkoutPlans(prevPlans =>
        prevPlans.map(plan =>
          plan._id === id ? response.data : plan
        )
      );
      addNotification('Workout plan updated successfully', 'success');
      return response.data;
    } catch (error) {
      console.error('Error updating workout plan:', error);
      addNotification('Failed to update workout plan', 'error');
      throw error;
    }
  };

  // Delete a workout plan
  const deleteWorkoutPlan = async (id) => {
    try {
      await axios.delete(`${API_URL}/workoutplans/${id}`, getAuthConfig());
      setWorkoutPlans(prevPlans => prevPlans.filter(plan => plan._id !== id));
      // Update workouts to mark the plan as deleted instead of removing the association
      setWorkoutHistory(prevHistory => 
        prevHistory.map(workout => 
          workout.plan && workout.plan._id === id 
            ? { ...workout, planDeleted: true, planName: workout.planName || 'Deleted Plan' } 
            : workout
        )
      );
      addNotification('Workout plan deleted successfully', 'success');
    } catch (error) {
      console.error('Error deleting workout plan:', error);
      addNotification('Failed to delete workout plan', 'error');
      throw error;
    }
  };

  // Add an exercise to a workout plan
  const addExerciseToPlan = async (planId, exerciseId) => {
    if (!planId || !exerciseId) {
      throw new Error('Plan ID and Exercise ID are required');
    }
    console.log(`Attempting to add exercise ${exerciseId} to plan ${planId}`);
    
    const plan = workoutPlans.find(p => p._id === planId);
    if (!plan) {
      console.error('Plan not found');
      addNotification('Plan not found', 'error');
      return { success: false, error: 'Plan not found' };
    }

    if (plan.exercises.some(e => e._id === exerciseId)) {
      console.log('Exercise is already in the workout plan');
      addNotification('This exercise is already in the workout plan', 'info');
      return { success: false, alreadyInPlan: true };
    }

    try {
      const response = await axios.post(
        `${API_URL}/workoutplans/${planId}/exercises`,
        { exerciseId },
        getAuthConfig()
      );
      
      console.log('Server response:', response.data);
      setWorkoutPlans(prevPlans =>
        prevPlans.map(p =>
          p._id === planId ? response.data : p
        )
      );
      addNotification('Exercise added to plan successfully', 'success');
      return { success: true, data: response.data };
    } catch (error) {
      console.error('Error adding exercise to plan:', error);
      addNotification(`Failed to add exercise to plan: ${error.response ? error.response.data.message : error.message}`, 'error');
      return { success: false, error };
    }
  };

  // Get the last workout for a given plan
  const getLastWorkoutByPlan = useCallback(async (planId) => {
    try {
      const response = await axios.get(`${API_URL}/workouts/last/${planId}`, getAuthConfig());
      return response.data;
    } catch (error) {
      if (error.response && error.response.status === 404) {
        // No previous workout found, this is not an error
        console.log('No previous workout found for this plan');
        return null;
      }
      console.error('Error fetching last workout:', error);
      addNotification('Failed to fetch last workout', 'error');
      return null;
    }
  }, [API_URL, getAuthConfig, addNotification]);

  const contextValue = useMemo(() => ({
    workouts,
    exercises,
    workoutPlans,
    workoutHistory,
    addWorkout,
    updateWorkout,
    deleteWorkout,
    addExercise,
    updateExercise,
    deleteExercise,
    addWorkoutPlan,
    updateWorkoutPlan,
    deleteWorkoutPlan,
    fetchWorkoutHistory,
    fetchWorkoutPlans,
    addExerciseToPlan,
    getLastWorkoutByPlan
  }), [workouts, exercises, workoutPlans, workoutHistory, getLastWorkoutByPlan, fetchWorkoutPlans, fetchWorkoutHistory]);

  return (
    <GymContext.Provider value={contextValue}>
      {children}
    </GymContext.Provider>
  );
}

export default GymProvider;
```

# src/context/AuthContext.jsx

```jsx
// src/context/AuthContext.jsx

import React, { createContext, useContext, useState, useEffect } from 'react';
import axios from 'axios';
import { hostName } from './GymContext';

const AuthContext = createContext();

export function useAuth() {
  return useContext(AuthContext);
}

export function AuthProvider({ children }) {
  const [user, setUser] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const checkLoggedIn = async () => {
      const token = localStorage.getItem('token');
      if (token) {
        try {
          const response = await axios.get(`${hostName}:4500/api/auth/user`, {
            headers: { 'x-auth-token': token }
          });
          setUser(response.data);
        } catch (error) {
          console.error('Error fetching user:', error);
          localStorage.removeItem('token');
        }
      }
      setLoading(false);
    };

    checkLoggedIn();
  }, []);

  const register = async (username, email, password) => {
    try {
      await axios.post(`${hostName}:4500/api/auth/register`, { username, email, password });
      return true;
    } catch (error) {
      console.error('Registration error:', error.response?.data || error.message);
      throw error;
    }
  };

  const login = async (username, password) => {
    try {
      const response = await axios.post(`${hostName}:4500/api/auth/login`, { username, password });
      localStorage.setItem('token', response.data.token);
      setUser(response.data.user);
      return response.data.user;
    } catch (error) {
      console.error('Login error:', error.response?.data || error.message);
      throw error;
    }
  };

  const logout = () => {
    localStorage.removeItem('token');
    setUser(null);
  };

  const value = {
    user,
    register,
    login,
    logout,
    loading
  };

  return (
    <AuthContext.Provider value={value}>
      {children}
    </AuthContext.Provider>
  );
}
```

# src/components/WorkoutPlanSelector.jsx

```jsx
// src/components/WorkoutPlanSelector.jsx

import React, { useState, useEffect } from 'react';
import { useGymContext } from '../context/GymContext';

function WorkoutPlanSelector({ onSelect, onClose }) {
  const [workoutPlans, setWorkoutPlans] = useState([]);
  const [isLoading, setIsLoading] = useState(true);
  const { fetchWorkoutPlans } = useGymContext();

  useEffect(() => {
    const getWorkoutPlans = async () => {
      try {
        setIsLoading(true);
        const plans = await fetchWorkoutPlans();
        setWorkoutPlans(plans || []);
      } catch (error) {
        console.error('Error fetching workout plans:', error);
      } finally {
        setIsLoading(false);
      }
    };
    getWorkoutPlans();
  }, [fetchWorkoutPlans]);

  const handleSelect = async (plan) => {
    await onSelect(plan);
    onClose();
  };

  if (isLoading) {
    return <div>Loading workout plans...</div>;
  }

  return (
    <div className="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center z-[60]">
      <div className="bg-white dark:bg-gray-800 p-5 rounded-lg shadow-xl max-w-md w-full m-4">
        <h2 className="text-xl font-bold mb-4 text-gray-900 dark:text-gray-100">Select Workout Plan</h2>
        {workoutPlans.length === 0 ? (
          <p className="text-gray-700 dark:text-gray-300">No workout plans available. Create a plan first.</p>
        ) : (
          workoutPlans.map((plan) => (
            <button
              key={plan._id}
              onClick={() => handleSelect(plan)}
              className="block w-full text-left p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded mb-2 text-gray-800 dark:text-gray-200"
            >
              {plan.name}
            </button>
          ))
        )}
        <button
          onClick={onClose}
          className="mt-4 bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded"
        >
          Cancel
        </button>
      </div>
    </div>
  );
}

export default WorkoutPlanSelector;
```

# src/components/WorkoutPlanModal.jsx

```jsx
// src/components/WorkoutPlanModal.jsx

import React from 'react';
import { useTheme } from '../context/ThemeContext';

function WorkoutPlanModal({ plan, onClose, onEdit, onStart }) {
  const { darkMode } = useTheme();

  if (!plan) return null;

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center z-50" id="my-modal">
      <div className={`relative mx-auto p-5 border w-full max-w-md shadow-lg rounded-md ${darkMode ? 'bg-gray-800 text-white' : 'bg-white text-gray-900'}`}>
        <div className="mt-3">
          <h3 className="text-lg leading-6 font-medium">{plan.name}</h3>
          <div className="mt-2 px-7 py-3">
            <p className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-500'}`}>
              Type: {plan.type || 'Not specified'}
            </p>
            <p className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-500'}`}>
              Scheduled: {plan.scheduledDate ? new Date(plan.scheduledDate).toLocaleString() : 'Not scheduled'}
            </p>
            <p className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-500'}`}>
              Status: {plan.completed ? 'Completed' : 'Scheduled'}
            </p>
            <div className="mt-4">
              <h4 className="text-md font-medium">Exercises:</h4>
              <ul className="list-disc list-inside">
                {plan.exercises.map((exercise, index) => (
                  <li key={index} className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-500'}`}>{exercise.name}</li>
                ))}
              </ul>
            </div>
          </div>
          <div className="flex justify-between items-center px-4 py-3">
            <button
              className={`px-4 py-2 ${darkMode ? 'bg-yellow-600 hover:bg-yellow-700' : 'bg-yellow-500 hover:bg-yellow-600'} text-white text-base font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-yellow-300`}
              onClick={() => {
                onEdit(plan);
                onClose();
              }}
            >
              Edit
            </button>
            <button
              className={`px-4 py-2 ${darkMode ? 'bg-green-600 hover:bg-green-700' : 'bg-green-500 hover:bg-green-600'} text-white text-base font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-green-300`}
              onClick={() => {
                onStart(plan);
                onClose();
              }}
            >
              Start Workout
            </button>
            <button
              className={`px-4 py-2 ${darkMode ? 'bg-blue-600 hover:bg-blue-700' : 'bg-blue-500 hover:bg-blue-600'} text-white text-base font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-300`}
              onClick={onClose}
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
  );
}

export default WorkoutPlanModal;
```

# src/components/WorkoutPlanForm.jsx

```jsx
// src/components/WorkoutPlanForm.jsx

import { useState, useEffect } from 'react';
import { useGymContext } from '../context/GymContext';
import { useTheme } from '../context/ThemeContext';

function WorkoutPlanForm({ onSubmit, initialPlan, onCancel }) {
  const [planName, setPlanName] = useState('');
  const [selectedExercises, setSelectedExercises] = useState([]);
  const [workoutType, setWorkoutType] = useState('');
  const [scheduledDate, setScheduledDate] = useState('');
  const [searchTerm, setSearchTerm] = useState('');
  const { exercises } = useGymContext();
  const { darkMode } = useTheme();

  useEffect(() => {
    if (initialPlan) {
      setPlanName(initialPlan.name);
      setSelectedExercises(initialPlan.exercises.map(exercise => exercise._id));
      setWorkoutType(initialPlan.type || '');
      setScheduledDate(initialPlan.scheduledDate ? new Date(initialPlan.scheduledDate).toISOString().split('T')[0] : '');
    } else {
      setPlanName('');
      setSelectedExercises([]);
      setWorkoutType('');
      setScheduledDate('');
    }
  }, [initialPlan]);

  const handleSubmit = async (e) => {
    e.preventDefault();
    const workoutPlan = {
      name: planName,
      exercises: selectedExercises,
      type: workoutType,
      scheduledDate: scheduledDate ? new Date(scheduledDate).toISOString() : null
    };
    
    if (initialPlan) {
      workoutPlan._id = initialPlan._id;
    }

    await onSubmit(workoutPlan);
  };

  const handleCancel = (e) => {
    e.preventDefault();
    onCancel();
  };

  const handleExerciseToggle = (exerciseId) => {
    setSelectedExercises(prevSelected =>
      prevSelected.includes(exerciseId)
        ? prevSelected.filter(id => id !== exerciseId)
        : [...prevSelected, exerciseId]
    );
  };

  const filteredExercises = exercises.filter(exercise =>
    exercise.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
    exercise.target.some(t => t.toLowerCase().includes(searchTerm.toLowerCase()))
  );

  const groupedExercises = filteredExercises.reduce((acc, exercise) => {
    exercise.target.forEach(target => {
      if (!acc[target]) {
        acc[target] = [];
      }
      acc[target].push(exercise);
    });
    return acc;
  }, {});

  return (
    <form onSubmit={handleSubmit} className={`max-w-4xl mx-auto mt-8 ${darkMode ? 'bg-gray-800 text-white' : 'bg-white text-gray-800'} shadow-md rounded px-8 pt-6 pb-8 mb-4`}>
      <div className="mb-4">
        <label htmlFor="planName" className="block text-sm font-bold mb-2">
          Workout Plan Name
        </label>
        <input
          type="text"
          id="planName"
          value={planName}
          onChange={(e) => setPlanName(e.target.value)}
          className={`shadow appearance-none border rounded w-full py-2 px-3 ${darkMode ? 'bg-gray-700 text-white' : 'text-gray-700'} leading-tight focus:outline-none focus:shadow-outline`}
          required
        />
      </div>
      <div className="mb-4">
        <label htmlFor="workoutType" className="block text-sm font-bold mb-2">
          Workout Type
        </label>
        <select
          id="workoutType"
          value={workoutType}
          onChange={(e) => setWorkoutType(e.target.value)}
          className={`shadow appearance-none border rounded w-full py-2 px-3 ${darkMode ? 'bg-gray-700 text-white' : 'text-gray-700'} leading-tight focus:outline-none focus:shadow-outline`}
          required
        >
          <option value="">Select a type</option>
          <option value="strength">Strength</option>
          <option value="cardio">Cardio</option>
          <option value="flexibility">Flexibility</option>
        </select>
      </div>
      <div className="mb-4">
        <label htmlFor="scheduledDate" className="block text-sm font-bold mb-2">
          Scheduled Date
        </label>
        <input
          type="date"
          id="scheduledDate"
          value={scheduledDate}
          onChange={(e) => setScheduledDate(e.target.value)}
          className={`shadow appearance-none border rounded w-full py-2 px-3 ${darkMode ? 'bg-gray-700 text-white' : 'text-gray-700'} leading-tight focus:outline-none focus:shadow-outline`}
        />
      </div>
      <div className="mb-4">
        <label className="block text-sm font-bold mb-2">
          Select Exercises
        </label>
        <input
          type="text"
          placeholder="Search exercises..."
          value={searchTerm}
          onChange={(e) => setSearchTerm(e.target.value)}
          className={`shadow appearance-none border rounded w-full py-2 px-3 ${darkMode ? 'bg-gray-700 text-white' : 'text-gray-700'} leading-tight focus:outline-none focus:shadow-outline mb-4`}
        />
        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div className={`border rounded p-4 ${darkMode ? 'bg-gray-700' : 'bg-gray-100'} overflow-y-auto h-96`}>
            {Object.entries(groupedExercises).map(([target, targetExercises]) => (
              <div key={target} className="mb-4">
                <h3 className="font-bold mb-2">{target}</h3>
                {targetExercises.map(exercise => (
                  <div key={exercise._id} className="flex items-center mb-2">
                    <input
                      type="checkbox"
                      id={`exercise-${exercise._id}`}
                      checked={selectedExercises.includes(exercise._id)}
                      onChange={() => handleExerciseToggle(exercise._id)}
                      className="mr-2"
                    />
                    <label htmlFor={`exercise-${exercise._id}`} className="text-sm">
                      {exercise.name}
                    </label>
                  </div>
                ))}
              </div>
            ))}
          </div>
          <div className={`border rounded p-4 ${darkMode ? 'bg-gray-700' : 'bg-gray-100'} overflow-y-auto h-96`}>
            <h3 className="font-bold mb-2">Selected Exercises</h3>
            {selectedExercises.map(exerciseId => {
              const exercise = exercises.find(e => e._id === exerciseId);
              return (
                <div key={exerciseId} className="flex items-center justify-between mb-2">
                  <span className="text-sm">{exercise.name}</span>
                  <button
                    type="button"
                    onClick={() => handleExerciseToggle(exerciseId)}
                    className="text-red-500 hover:text-red-700"
                  >
                    Remove
                  </button>
                </div>
              );
            })}
          </div>
        </div>
      </div>
      <div className="flex items-center justify-between mt-6">
        <button
          type="submit"
          className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
        >
          {initialPlan ? 'Update Workout Plan' : 'Create Workout Plan'}
        </button>
        <button
          type="button"
          onClick={handleCancel}
          className="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
        >
          Cancel
        </button>
      </div>
    </form>
  );
}

export default WorkoutPlanForm;
```

# src/components/WorkoutPlanDetails.jsx

```jsx
// src/components/WorkoutPlanDetails.jsx

import React, { useState, useEffect } from 'react';
import { useParams, useNavigate } from 'react-router-dom';
import { useGymContext } from '../context/GymContext';

function WorkoutPlanDetails() {
  const { id } = useParams();
  const { workoutPlans, updateWorkoutPlan, deleteWorkoutPlan } = useGymContext();
  const [plan, setPlan] = useState(null);
  const navigate = useNavigate();

  useEffect(() => {
    const foundPlan = workoutPlans.find(p => p._id === id);
    setPlan(foundPlan);
  }, [id, workoutPlans]);

  const handleDelete = async () => {
    if (window.confirm('Are you sure you want to delete this workout plan?')) {
      await deleteWorkoutPlan(id);
      navigate('/plans');
    }
  };

  const handleReschedule = () => {
    const newDate = prompt('Enter new date (YYYY-MM-DD):', plan.scheduledDate ? new Date(plan.scheduledDate).toISOString().split('T')[0] : '');
    if (newDate) {
      const updatedPlan = { ...plan, scheduledDate: new Date(newDate) };
      updateWorkoutPlan(id, updatedPlan);
    }
  };

  if (!plan) {
    return <div>Loading workout plan...</div>;
  }

  return (
    <div className="p-4">
      <h2 className="text-2xl font-bold mb-4">{plan.name}</h2>
      <p><strong>Type:</strong> {plan.type || 'Not specified'}</p>
      <p><strong>Scheduled Date:</strong> {plan.scheduledDate ? new Date(plan.scheduledDate).toLocaleDateString() : 'Not scheduled'}</p>
      
      <h3 className="text-xl font-semibold mt-4 mb-2">Exercises:</h3>
      <ul className="list-disc list-inside">
        {plan.exercises.map((exercise, index) => (
          <li key={index}>{exercise.name}</li>
        ))}
      </ul>

      <div className="mt-4">
        <button onClick={handleReschedule} className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mr-2">
          Reschedule
        </button>
        <button onClick={handleDelete} className="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">
          Delete Plan
        </button>
      </div>
    </div>
  );
}

export default WorkoutPlanDetails;
```

# src/components/WorkoutPlanCard.jsx

```jsx
// src/components/WorkoutPlanCard.jsx

import React, { useState } from 'react';
import { useTheme } from '../context/ThemeContext';
// Import icons from react-icons
import { FiPlay, FiEdit, FiTrash2 } from 'react-icons/fi';

function WorkoutPlanCard({ plan, onStart, onEdit, onDelete }) {
  const { darkMode } = useTheme();
  const [isDeleteConfirmOpen, setIsDeleteConfirmOpen] = useState(false);

  const handleAction = (action, e) => {
    e.stopPropagation();
    if (action === onDelete) {
      setIsDeleteConfirmOpen(true);
    } else {
      action(plan);
    }
  };

  const confirmDelete = (e) => {
    e.stopPropagation();
    onDelete(plan._id);
    setIsDeleteConfirmOpen(false);
  };

  const cancelDelete = (e) => {
    e.stopPropagation();
    setIsDeleteConfirmOpen(false);
  };

  const typeColors = {
    strength: 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300',
    cardio: 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300',
    flexibility: 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300',
    other: 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300'
  };

  const buttonStyles = {
    base: 'text-xs font-semibold py-1 px-2 rounded transition-all duration-200 flex items-center justify-center',
    start: 'bg-emerald-500 text-white hover:bg-emerald-600 dark:bg-emerald-600 dark:hover:bg-emerald-700 hover:shadow-md',
    edit: 'bg-indigo-500 text-white hover:bg-indigo-600 dark:bg-indigo-600 dark:hover:bg-indigo-700 hover:shadow-md',
    delete: 'bg-rose-500 text-white hover:bg-rose-600 dark:bg-rose-600 dark:hover:bg-rose-700 hover:shadow-md'
  };

  const TypeBadge = () => (
    <span className={`px-2 py-1 text-xs font-semibold rounded-full ${typeColors[plan.type] || typeColors.other}`}>
      {plan.type || 'Other'}
    </span>
  );

  const ActionButton = ({ action, style, icon, text }) => (
    <button 
      onClick={(e) => handleAction(action, e)}
      className={`${buttonStyles.base} ${style}`}
    >
      {icon}
      <span className="ml-1">{text}</span>
    </button>
  );

  const DeleteConfirmation = () => (
    <div className="absolute inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center rounded-lg z-10">
      <div className="bg-white dark:bg-gray-700 p-4 rounded-lg text-center">
        <p className="mb-4 text-sm">Are you sure you want to delete this workout plan?</p>
        <div className="flex justify-center space-x-2">
          <button onClick={confirmDelete} className={`${buttonStyles.base} ${buttonStyles.delete}`}>
            <FiTrash2 className="mr-1" />
            Yes, Delete
          </button>
          <button onClick={cancelDelete} className={`${buttonStyles.base} bg-gray-300 text-gray-800 hover:bg-gray-400`}>
            Cancel
          </button>
        </div>
      </div>
    </div>
  );

  return (
    <div className={`relative border rounded-lg p-4 mb-4 shadow-sm ${darkMode ? 'bg-gray-700 text-white' : 'bg-white text-gray-800'} transition-transform duration-300 hover:scale-105`}>
      <div className="flex justify-between items-center mb-2">
        <h3 className="text-xl font-semibold">{plan.name}</h3>
        <TypeBadge />
      </div>
      <p className="text-sm text-gray-600 dark:text-gray-300 mb-2">
        Scheduled: {plan.scheduledDate ? new Date(plan.scheduledDate).toLocaleDateString() : 'Not scheduled'}
      </p>
      <div className="mb-4 max-h-40 overflow-y-auto">
        <h4 className="font-semibold mb-1">Exercises:</h4>
        <ul className="list-disc list-inside">
          {plan.exercises.map((exercise) => (
            <li key={exercise._id} className="mb-1">
              <span className="font-medium">{exercise.name}</span>
            </li>
          ))}
        </ul>
      </div>
      <div className="flex justify-between">
        <ActionButton action={onStart} style={buttonStyles.start} icon={<FiPlay className="mr-1" />} text="Start Workout" />
        <ActionButton action={onEdit} style={buttonStyles.edit} icon={<FiEdit className="mr-1" />} text="Edit Plan" />
        <ActionButton action={onDelete} style={buttonStyles.delete} icon={<FiTrash2 className="mr-1" />} text="Delete Plan" />
      </div>
      {isDeleteConfirmOpen && <DeleteConfirmation />}
    </div>
  );
}

export default WorkoutPlanCard;
```

# src/components/WorkoutForm.jsx

```jsx
// src/components/WorkoutForm.jsx
import { useState, useEffect } from 'react';
import { useGymContext } from '../context/GymContext';

function WorkoutForm({ onSave, initialWorkout }) {
  const [selectedExercise, setSelectedExercise] = useState('');
  const [sets, setSets] = useState('');
  const [reps, setReps] = useState('');
  const [weight, setWeight] = useState('');
  const { exercises } = useGymContext();

  useEffect(() => {
    if (initialWorkout) {
      setSelectedExercise(initialWorkout.exercise);
      setSets(initialWorkout.sets.toString());
      setReps(initialWorkout.reps.toString());
      setWeight(initialWorkout.weight.toString());
    }
  }, [initialWorkout]);

  const handleSubmit = (e) => {
    e.preventDefault();
    const workout = {
      exercise: selectedExercise,
      sets: parseInt(sets),
      reps: parseInt(reps),
      weight: parseFloat(weight),
      date: new Date().toISOString()
    };
    onSave(workout);
    // Reset form
    setSelectedExercise('');
    setSets('');
    setReps('');
    setWeight('');
  };

  return (
    <form onSubmit={handleSubmit} className="max-w-md mx-auto mt-8">
      <div className="mb-4">
        <label htmlFor="exercise" className="block text-gray-700 font-bold mb-2">
          Exercise
        </label>
        <select
          id="exercise"
          value={selectedExercise}
          onChange={(e) => setSelectedExercise(e.target.value)}
          className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
          required
        >
          <option value="">Select an exercise</option>
          {exercises.map((exercise) => (
            <option key={exercise._id} value={exercise.name}>
              {exercise.name}
            </option>
          ))}
        </select>
      </div>
      <div className="mb-4">
        <label htmlFor="sets" className="block text-gray-700 font-bold mb-2">
          Sets
        </label>
        <input
          type="number"
          id="sets"
          value={sets}
          onChange={(e) => setSets(e.target.value)}
          className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
          required
        />
      </div>
      <div className="mb-4">
        <label htmlFor="reps" className="block text-gray-700 font-bold mb-2">
          Reps
        </label>
        <input
          type="number"
          id="reps"
          value={reps}
          onChange={(e) => setReps(e.target.value)}
          className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
          required
        />
      </div>
      <div className="mb-6">
        <label htmlFor="weight" className="block text-gray-700 font-bold mb-2">
          Weight (kg)
        </label>
        <input
          type="number"
          id="weight"
          value={weight}
          onChange={(e) => setWeight(e.target.value)}
          className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
          step="0.1"
          required
        />
      </div>
      <div className="flex items-center justify-between">
        <button
          type="submit"
          className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
        >
          {initialWorkout ? 'Update Workout' : 'Log Workout'}
        </button>
      </div>
    </form>
  );
}

export default WorkoutForm;
```

# src/components/WorkoutCalendar.jsx

```jsx
// src/components/WorkoutCalendar.jsx

import React, { useState, useEffect, useCallback, useMemo } from 'react';
import { Calendar, momentLocalizer } from 'react-big-calendar';
import withDragAndDrop from 'react-big-calendar/lib/addons/dragAndDrop';
import moment from 'moment';
import 'react-big-calendar/lib/css/react-big-calendar.css';
import 'react-big-calendar/lib/addons/dragAndDrop/styles.css';
import { useGymContext } from '../context/GymContext';
import { useNavigate } from 'react-router-dom';
import { useNotification } from '../context/NotificationContext';
import { useTheme } from '../context/ThemeContext';
import WorkoutPlanModal from './WorkoutPlanModal';
import './WorkoutCalendar.css';

const localizer = momentLocalizer(moment);
const DnDCalendar = withDragAndDrop(Calendar);

const workoutColors = {
  strength: '#4CAF50',
  cardio: '#2196F3',
  flexibility: '#FF9800',
  default: '#9C27B0',
  completed: '#607D8B'
};

function WorkoutCalendar({ filteredPlans = [], onEditPlan, onStartWorkout }) {
  const { workoutHistory, updateWorkoutPlan } = useGymContext();
  const [selectedPlan, setSelectedPlan] = useState(null);
  const navigate = useNavigate();
  const { addNotification } = useNotification();
  const { darkMode } = useTheme();

  const getEventColor = useCallback((event) => {
    if (event.resource === 'history' || event.resource === 'completed') {
      return workoutColors.completed;
    }
    const plan = filteredPlans.find(p => p._id === event.id);
    return plan && plan.type ? workoutColors[plan.type] : workoutColors.default;
  }, [filteredPlans]);

  const events = useMemo(() => {
    const historyEvents = workoutHistory.map(workout => ({
      id: workout._id,
      title: `${workout.planName} (Completed)`,
      start: new Date(workout.startTime),
      end: new Date(workout.endTime),
      allDay: false,
      resource: 'history'
    }));

    const planEvents = filteredPlans
      .filter(plan => plan.scheduledDate)
      .map(plan => ({
        id: plan._id,
        title: plan.name,
        start: new Date(plan.scheduledDate),
        end: new Date(new Date(plan.scheduledDate).setHours(new Date(plan.scheduledDate).getHours() + 1)),
        allDay: false,
        resource: plan.completed ? 'completed' : 'scheduled'
      }));

    return [...historyEvents, ...planEvents];
  }, [workoutHistory, filteredPlans]);

  const handleSelectEvent = useCallback((event) => {
    if (event.resource === 'history') {
      navigate(`/workout-summary/${event.id}`);
    } else {
      const plan = filteredPlans.find(p => p._id === event.id);
      setSelectedPlan(plan);
    }
  }, [filteredPlans, navigate]);

  const handleSelectSlot = useCallback(({ start }) => {
    const planName = prompt('Enter workout plan name:');
    if (planName) {
      const workoutType = prompt('Enter workout type (strength, cardio, flexibility):');
      const newPlan = {
        name: planName,
        exercises: [],
        scheduledDate: start,
        type: workoutType
      };
      updateWorkoutPlan(null, newPlan);
    }
  }, [updateWorkoutPlan]);

  const moveEvent = useCallback(({ event, start, end }) => {
    if (event.resource === 'history' || event.resource === 'completed') {
      addNotification('Cannot reschedule completed workouts', 'error');
      return;
    }

    const updatedPlan = filteredPlans.find(plan => plan._id === event.id);
    if (updatedPlan) {
      updatedPlan.scheduledDate = start;
      updateWorkoutPlan(event.id, updatedPlan);
      addNotification('Workout rescheduled successfully', 'success');
    }
  }, [filteredPlans, updateWorkoutPlan, addNotification]);

  const resizeEvent = useCallback(({ event, start, end }) => {
    if (event.resource === 'history' || event.resource === 'completed') {
      addNotification('Cannot modify completed workouts', 'error');
      return;
    }

    const updatedPlan = filteredPlans.find(plan => plan._id === event.id);
    if (updatedPlan) {
      updatedPlan.scheduledDate = start;
      updateWorkoutPlan(event.id, updatedPlan);
      addNotification('Workout duration updated successfully', 'success');
    }
  }, [filteredPlans, updateWorkoutPlan, addNotification]);

  const eventPropGetter = useCallback((event) => {
    const backgroundColor = getEventColor(event);
    return {
      style: {
        backgroundColor,
        borderRadius: '5px',
        opacity: event.resource === 'history' || event.resource === 'completed' ? 0.7 : 1,
        color: '#fff',
        border: 'none',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        fontSize: '14px',
        fontWeight: '500',
        cursor: event.resource === 'history' || event.resource === 'completed' ? 'not-allowed' : 'pointer'
      }
    };
  }, [getEventColor]);

  return (
    <div className={`h-full ${darkMode ? 'bg-gray-700' : 'bg-white'} rounded-lg shadow-lg p-4`}>
      <DnDCalendar
        localizer={localizer}
        events={events}
        startAccessor="start"
        endAccessor="end"
        style={{ height: '100%' }}
        onSelectSlot={handleSelectSlot}
        onSelectEvent={handleSelectEvent}
        onEventDrop={moveEvent}
        onEventResize={resizeEvent}
        selectable
        resizable
        eventPropGetter={eventPropGetter}
        draggableAccessor={(event) => event.resource !== 'history' && event.resource !== 'completed'}
        views={['month', 'week', 'day']}
        defaultView="month"
        formats={{
          monthHeaderFormat: (date, culture, localizer) =>
            localizer.format(date, 'MMMM YYYY', culture),
          dayHeaderFormat: (date, culture, localizer) =>
            localizer.format(date, 'dddd, MMMM D', culture),
        }}
        components={{
          toolbar: CustomToolbar,
        }}
      />
      {selectedPlan && (
        <WorkoutPlanModal
          plan={selectedPlan}
          onClose={() => setSelectedPlan(null)}
          onEdit={onEditPlan}
          onStart={onStartWorkout}
        />
      )}
    </div>
  );
}

const CustomToolbar = (toolbar) => {
  const goToBack = () => {
    toolbar.date.setMonth(toolbar.date.getMonth() - 1);
    toolbar.onNavigate('prev');
  };

  const goToNext = () => {
    toolbar.date.setMonth(toolbar.date.getMonth() + 1);
    toolbar.onNavigate('next');
  };

  const goToCurrent = () => {
    const now = new Date();
    toolbar.date.setMonth(now.getMonth());
    toolbar.date.setYear(now.getFullYear());
    toolbar.onNavigate('current');
  };

  const label = () => {
    const date = moment(toolbar.date);
    return (
      <span className="text-lg font-semibold">{date.format('MMMM YYYY')}</span>
    );
  };

  return (
    <div className="flex justify-between items-center mb-4">
      <div>
        <button
          className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mr-2"
          onClick={goToBack}
        >
          &lt;
        </button>
        <button
          className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"
          onClick={goToNext}
        >
          &gt;
        </button>
      </div>
      <div>{label()}</div>
      <button
        className="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded"
        onClick={goToCurrent}
      >
        Today
      </button>
    </div>
  );
};

export default WorkoutCalendar;
```

# src/components/WorkoutCalendar.css

```css
/* src/components/WorkoutCalendar.css */

.rbc-calendar {
  font-family: 'Arial', sans-serif;
}

.rbc-header {
  padding: 10px 3px;
  font-weight: bold;
  font-size: 14px;
}

.rbc-button-link {
  color: #333;
}

.rbc-off-range-bg {
  background-color: #f0f0f0;
}

.rbc-today {
  background-color: #e6f7ff;
}

.rbc-event {
  border: none !important;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.rbc-event-content {
  font-size: 12px;
  font-weight: bold;
}

.rbc-toolbar button {
  color: #333;
  border: 1px solid #ccc;
  border-radius: 4px;
  padding: 5px 10px;
}

.rbc-toolbar button:hover {
  background-color: #f0f0f0;
}

.rbc-toolbar button:active,
.rbc-toolbar button.rbc-active {
  background-color: #e0e0e0;
  border-color: #999;
}

/* Dark mode styles */
.dark .rbc-calendar {
  color: #fff;
}

.dark .rbc-off-range-bg {
  background-color: #2a2a2a;
}

.dark .rbc-today {
  background-color: #1a3a4a;
}

.dark .rbc-button-link {
  color: #fff;
}

.dark .rbc-toolbar button {
  color: #fff;
  border-color: #666;
}

.dark .rbc-toolbar button:hover {
  background-color: #444;
}

.dark .rbc-toolbar button:active,
.dark .rbc-toolbar button.rbc-active {
  background-color: #555;
  border-color: #888;
}
```

# src/components/Register.jsx

```jsx
// src/components/Register.jsx

import React, { useState } from 'react';
import { useAuth } from '../context/AuthContext';
import { useNavigate, Link } from 'react-router-dom';
import { useNotification } from '../context/NotificationContext';
import { useTheme } from '../context/ThemeContext';
import { FiUser, FiMail, FiLock, FiEye, FiEyeOff } from 'react-icons/fi';

function Register() {
  const [username, setUsername] = useState('');
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [confirmPassword, setConfirmPassword] = useState('');
  const [showPassword, setShowPassword] = useState(false);
  const [showConfirmPassword, setShowConfirmPassword] = useState(false);
  const [errors, setErrors] = useState({});
  const { register } = useAuth();
  const navigate = useNavigate();
  const { addNotification } = useNotification();
  const { darkMode } = useTheme();

  const validateForm = () => {
    const newErrors = {};
    if (!username.trim()) newErrors.username = 'Username is required';
    if (!email.trim()) newErrors.email = 'Email is required';
    else if (!/\S+@\S+\.\S+/.test(email)) newErrors.email = 'Email is invalid';
    if (!password) newErrors.password = 'Password is required';
    else if (password.length < 6) newErrors.password = 'Password must be at least 6 characters';
    if (password !== confirmPassword) newErrors.confirmPassword = 'Passwords do not match';
    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    if (validateForm()) {
      try {
        await register(username, email, password);
        addNotification('Registration successful! Please log in.', 'success');
        navigate('/login');
      } catch (err) {
        addNotification('Registration failed: ' + (err.response?.data?.message || 'Unknown error'), 'error');
      }
    }
  };

  return (
    <div className={`flex items-center justify-center min-h-screen bg-gray-100 ${darkMode ? 'dark' : ''}`}>
      <div className="px-8 py-6 mt-4 text-left bg-white shadow-lg dark:bg-gray-800 rounded-lg">
        <h3 className="text-2xl font-bold text-center text-gray-800 dark:text-white">Create an account</h3>
        <form onSubmit={handleSubmit}>
          <div className="mt-4">
            <div className="relative">
              <label className="block text-gray-700 dark:text-gray-300" htmlFor="username">Username</label>
              <div className="flex items-center">
                <FiUser className="absolute left-3 text-gray-400" />
                <input
                  type="text"
                  placeholder="Enter Username"
                  id="username"
                  className={`w-full px-4 py-2 pl-10 mt-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-600 dark:bg-gray-700 dark:text-white dark:border-gray-600 ${errors.username ? 'border-red-500' : ''}`}
                  value={username}
                  onChange={(e) => setUsername(e.target.value)}
                />
              </div>
              {errors.username && <p className="text-red-500 text-xs mt-1">{errors.username}</p>}
            </div>
            <div className="mt-4 relative">
              <label className="block text-gray-700 dark:text-gray-300" htmlFor="email">Email</label>
              <div className="flex items-center">
                <FiMail className="absolute left-3 text-gray-400" />
                <input
                  type="email"
                  placeholder="Enter Email"
                  id="email"
                  className={`w-full px-4 py-2 pl-10 mt-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-600 dark:bg-gray-700 dark:text-white dark:border-gray-600 ${errors.email ? 'border-red-500' : ''}`}
                  value={email}
                  onChange={(e) => setEmail(e.target.value)}
                />
              </div>
              {errors.email && <p className="text-red-500 text-xs mt-1">{errors.email}</p>}
            </div>
            <div className="mt-4 relative">
              <label className="block text-gray-700 dark:text-gray-300" htmlFor="password">Password</label>
              <div className="flex items-center">
                <FiLock className="absolute left-3 text-gray-400" />
                <input
                  type={showPassword ? "text" : "password"}
                  placeholder="Enter Password"
                  id="password"
                  className={`w-full px-4 py-2 pl-10 mt-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-600 dark:bg-gray-700 dark:text-white dark:border-gray-600 ${errors.password ? 'border-red-500' : ''}`}
                  value={password}
                  onChange={(e) => setPassword(e.target.value)}
                />
                <button
                  type="button"
                  className="absolute inset-y-0 right-0 pr-3 flex items-center text-sm leading-5"
                  onClick={() => setShowPassword(!showPassword)}
                >
                  {showPassword ? <FiEyeOff className="text-gray-400" /> : <FiEye className="text-gray-400" />}
                </button>
              </div>
              {errors.password && <p className="text-red-500 text-xs mt-1">{errors.password}</p>}
            </div>
            <div className="mt-4 relative">
              <label className="block text-gray-700 dark:text-gray-300" htmlFor="confirmPassword">Confirm Password</label>
              <div className="flex items-center">
                <FiLock className="absolute left-3 text-gray-400" />
                <input
                  type={showConfirmPassword ? "text" : "password"}
                  placeholder="Confirm Password"
                  id="confirmPassword"
                  className={`w-full px-4 py-2 pl-10 mt-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-600 dark:bg-gray-700 dark:text-white dark:border-gray-600 ${errors.confirmPassword ? 'border-red-500' : ''}`}
                  value={confirmPassword}
                  onChange={(e) => setConfirmPassword(e.target.value)}
                />
                <button
                  type="button"
                  className="absolute inset-y-0 right-0 pr-3 flex items-center text-sm leading-5"
                  onClick={() => setShowConfirmPassword(!showConfirmPassword)}
                >
                  {showConfirmPassword ? <FiEyeOff className="text-gray-400" /> : <FiEye className="text-gray-400" />}
                </button>
              </div>
              {errors.confirmPassword && <p className="text-red-500 text-xs mt-1">{errors.confirmPassword}</p>}
            </div>
            <div className="flex items-center justify-between mt-6">
              <button
                type="submit"
                className="px-6 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-900 transition duration-300 ease-in-out"
              >
                Register
              </button>
            </div>
          </div>
        </form>
        <div className="mt-6 text-center">
          <p className="text-sm text-gray-600 dark:text-gray-400">
            Already have an account?{' '}
            <Link to="/login" className="font-medium text-blue-600 hover:underline dark:text-blue-400">
              Log in
            </Link>
          </p>
        </div>
      </div>
    </div>
  );
}

export default Register;
```

# src/components/NotificationToast.jsx

```jsx
// src/components/NotificationToast.jsx

import React from 'react';
import { useNotification } from '../context/NotificationContext';

function NotificationToast() {
  const { notifications, removeNotification } = useNotification();

  return (
    <div className="fixed top-4 right-4 z-50">
      {notifications.map((notification) => (
        <div
          key={notification.id}
          className={`mb-2 p-4 rounded shadow-md ${
            notification.type === 'error' ? 'bg-red-500' : 
            notification.type === 'success' ? 'bg-green-500' : 
            notification.type === 'info' ? 'bg-blue-500' : 'bg-yellow-500'
          } text-white`}
        >
          {notification.message}
          <button
            onClick={() => removeNotification(notification.id)}
            className="ml-2 text-white font-bold"
          >
            &times;
          </button>
        </div>
      ))}
    </div>
  );
}

export default NotificationToast;
```

# src/components/Login.jsx

```jsx
// src/components/Login.jsx

import React, { useState } from 'react';
import { useAuth } from '../context/AuthContext';
import { useNavigate, Link } from 'react-router-dom';
import { useNotification } from '../context/NotificationContext';
import { useTheme } from '../context/ThemeContext';
import { FiEye, FiEyeOff, FiUser, FiLock } from 'react-icons/fi';

function Login() {
  const [username, setUsername] = useState('');
  const [password, setPassword] = useState('');
  const [showPassword, setShowPassword] = useState(false);
  const [errors, setErrors] = useState({});
  const { login } = useAuth();
  const navigate = useNavigate();
  const { addNotification } = useNotification();
  const { darkMode } = useTheme();

  const validateForm = () => {
    const newErrors = {};
    if (!username.trim()) newErrors.username = 'Username is required';
    if (!password) newErrors.password = 'Password is required';
    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    if (validateForm()) {
      try {
        await login(username, password);
        addNotification('Logged in successfully', 'success');
        navigate('/');
      } catch (err) {
        addNotification('Failed to log in: ' + (err.response?.data?.message || 'Unknown error'), 'error');
      }
    }
  };

  return (
    <div className={`flex items-center justify-center min-h-screen bg-gray-100 ${darkMode ? 'dark' : ''}`}>
      <div className="px-8 py-6 mt-4 text-left bg-white shadow-lg dark:bg-gray-800 rounded-lg">
        <h3 className="text-2xl font-bold text-center text-gray-800 dark:text-white">Login to your account</h3>
        <form onSubmit={handleSubmit}>
          <div className="mt-4">
            <div className="relative">
              <label className="block text-gray-700 dark:text-gray-300" htmlFor="username">Username</label>
              <div className="flex items-center">
                <FiUser className="absolute left-3 text-gray-400" />
                <input
                  type="text"
                  placeholder="Enter Username"
                  id="username"
                  className={`w-full px-4 py-2 pl-10 mt-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-600 dark:bg-gray-700 dark:text-white dark:border-gray-600 ${errors.username ? 'border-red-500' : ''}`}
                  value={username}
                  onChange={(e) => setUsername(e.target.value)}
                />
              </div>
              {errors.username && <p className="text-red-500 text-xs mt-1">{errors.username}</p>}
            </div>
            <div className="mt-4 relative">
              <label className="block text-gray-700 dark:text-gray-300" htmlFor="password">Password</label>
              <div className="flex items-center">
                <FiLock className="absolute left-3 text-gray-400" />
                <input
                  type={showPassword ? "text" : "password"}
                  placeholder="Enter Password"
                  id="password"
                  className={`w-full px-4 py-2 pl-10 mt-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-600 dark:bg-gray-700 dark:text-white dark:border-gray-600 ${errors.password ? 'border-red-500' : ''}`}
                  value={password}
                  onChange={(e) => setPassword(e.target.value)}
                />
                <button
                  type="button"
                  className="absolute inset-y-0 right-0 pr-3 flex items-center text-sm leading-5"
                  onClick={() => setShowPassword(!showPassword)}
                >
                  {showPassword ? <FiEyeOff className="text-gray-400" /> : <FiEye className="text-gray-400" />}
                </button>
              </div>
              {errors.password && <p className="text-red-500 text-xs mt-1">{errors.password}</p>}
            </div>
            <div className="flex items-center justify-between mt-4">
              <button
                type="submit"
                className="px-6 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-900 transition duration-300 ease-in-out"
              >
                Login
              </button>
              <Link to="/forgot-password" className="text-sm text-blue-600 hover:underline dark:text-blue-400">Forgot password?</Link>
            </div>
          </div>
        </form>
        <div className="mt-6 text-center">
          <p className="text-sm text-gray-600 dark:text-gray-400">
            Don't have an account?{' '}
            <Link to="/register" className="font-medium text-blue-600 hover:underline dark:text-blue-400">
              Sign up
            </Link>
          </p>
        </div>
      </div>
    </div>
  );
}

export default Login;
```

# src/components/IndividualWorkoutSummary.jsx

```jsx
// src/components/IndividualWorkoutSummary.jsx

import React, { useState, useEffect } from 'react';
import { useParams } from 'react-router-dom';
import { useGymContext } from '../context/GymContext';
import { useTheme } from '../context/ThemeContext';

function IndividualWorkoutSummary() {
  const { id } = useParams();
  const { workoutHistory } = useGymContext();
  const [workout, setWorkout] = useState(null);
  const { darkMode } = useTheme();

  useEffect(() => {
    const foundWorkout = workoutHistory.find(w => w._id === id);
    setWorkout(foundWorkout);
  }, [id, workoutHistory]);

  if (!workout) {
    return <div>Loading workout summary...</div>;
  }

  const formatDuration = (start, end) => {
    const duration = new Date(end) - new Date(start);
    const hours = Math.floor(duration / 3600000);
    const minutes = Math.floor((duration % 3600000) / 60000);
    return `${hours}h ${minutes}m`;
  };

  return (
    <div className={`p-4 ${darkMode ? 'bg-gray-800 text-white' : 'bg-white text-gray-800'}`}>
      <h2 className="text-2xl font-bold mb-4">Workout Summary</h2>
      <p><strong>Date:</strong> {new Date(workout.startTime).toLocaleDateString()}</p>
      <p><strong>Duration:</strong> {formatDuration(workout.startTime, workout.endTime)}</p>
      <p><strong>Plan:</strong> {workout.planName}</p>
      <p><strong>Progression:</strong> {workout.progression ? `${workout.progression.toFixed(2)}%` : 'N/A'}</p>
      <p><strong>Total Pause Time:</strong> {workout.totalPauseTime ? `${workout.totalPauseTime} seconds` : 'N/A'}</p>
      <p><strong>Skipped Pauses:</strong> {workout.skippedPauses || 0}</p>
      
      <h3 className="text-xl font-semibold mt-4 mb-2">Exercises:</h3>
      {workout.exercises.map((exercise, index) => (
        <div key={index} className={`mb-4 p-3 rounded ${darkMode ? 'bg-gray-700' : 'bg-gray-100'}`}>
          <h4 className="text-lg font-medium">{exercise.exercise ? exercise.exercise.name : 'Unknown Exercise'}</h4>
          <ul className="list-disc list-inside">
            {exercise.sets.map((set, setIndex) => (
              <li key={setIndex}>
                Set {setIndex + 1}: {set.weight} lbs x {set.reps} reps
                {set.skippedRest && <span className="text-yellow-500 ml-2">(Rest Skipped)</span>}
              </li>
            ))}
          </ul>
          {exercise.notes && (
            <p className="mt-2 italic">Notes: {exercise.notes}</p>
          )}
        </div>
      ))}
    </div>
  );
}

export default IndividualWorkoutSummary;
```

# src/components/Header.jsx

```jsx
// src/components/Header.jsx

import React, { useState } from 'react';
import { Link } from 'react-router-dom';
import { useAuth } from '../context/AuthContext';
import { useTheme } from '../context/ThemeContext';

function Header() {
  const { user, logout } = useAuth();
  const { darkMode, toggleDarkMode } = useTheme();
  const [isMenuOpen, setIsMenuOpen] = useState(false);

  const handleLogout = () => {
    logout();
    setIsMenuOpen(false);
  };

  const menuItems = [
    { to: "/dashboard", text: "Dashboard" },
    { to: "/tracker", text: "Workout Tracker" },
    { to: "/exercises", text: "Exercise Library" },
    { to: "/plans", text: "Workout Plans" },
    { to: "/workout-summary", text: "Workout History" },
  ];

  const MenuItem = ({ to, text, onClick }) => (
    <Link 
      to={to} 
      className="block py-2 px-4 text-sm hover:bg-gray-700 text-gray-300 hover:text-white"
      onClick={() => {
        setIsMenuOpen(false);
        onClick && onClick();
      }}
    >
      {text}
    </Link>
  );

  const AuthButton = ({ to, text }) => (
    <Link 
      to={to} 
      className="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded transition duration-300 ease-in-out"
    >
      {text}
    </Link>
  );

  return (
    <header className="bg-gray-800 text-white">
      <div className="container mx-auto px-4 py-3">
        <div className="flex justify-between items-center">
          <Link to="/" className="text-2xl font-heading font-bold">Gym App</Link>
          
          {/* Desktop Menu */}
          <div className="hidden md:flex space-x-4 items-center">
            {user ? (
              <>
                {menuItems.map((item) => (
                  <MenuItem key={item.to} to={item.to} text={item.text} />
                ))}
                <button 
                  onClick={handleLogout}
                  className="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded transition duration-300 ease-in-out"
                >
                  Logout
                </button>
              </>
            ) : (
              <>
                <AuthButton to="/login" text="Login" />
                <AuthButton to="/register" text="Register" />
              </>
            )}
            <button 
              onClick={toggleDarkMode}
              className="ml-4 p-2 rounded-full bg-gray-700 hover:bg-gray-600 transition duration-300 ease-in-out"
            >
              {darkMode ? '🌞' : '🌙'}
            </button>
          </div>

          {/* Mobile Menu Button */}
          <button 
            className="md:hidden text-white focus:outline-none"
            onClick={() => setIsMenuOpen(!isMenuOpen)}
          >
            {isMenuOpen ? (
              <svg className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
              </svg>
            ) : (
              <svg className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16m-7 6h7" />
              </svg>
            )}
          </button>
        </div>

        {/* Mobile Menu */}
        {isMenuOpen && (
          <div className="md:hidden mt-4 bg-gray-700 rounded-lg shadow-lg">
            {user ? (
              <>
                {menuItems.map((item) => (
                  <MenuItem key={item.to} to={item.to} text={item.text} />
                ))}
                <MenuItem to="/" text="Logout" onClick={handleLogout} />
              </>
            ) : (
              <>
                <AuthButton to="/login" text="Login" />
                <AuthButton to="/register" text="Register" />
              </>
            )}
            <button 
              onClick={() => {
                toggleDarkMode();
                setIsMenuOpen(false);
              }}
              className="block w-full text-left py-2 px-4 text-sm hover:bg-gray-600 text-gray-300 hover:text-white"
            >
              {darkMode ? 'Switch to Light Mode' : 'Switch to Dark Mode'}
            </button>
          </div>
        )}
      </div>
    </header>
  );
}

export default Header;
```

# src/components/Footer.jsx

```jsx
// src/components/Footer.jsx
function Footer() {
  return (
    <footer className="bg-gray-200 p-4 mt-8">
      <div className="container mx-auto text-center">
        <p>&copy; 2024 Gym App. All rights reserved.</p>
      </div>
    </footer>
  );
}

export default Footer;
```

# src/components/ExerciseModal.jsx

```jsx
// src/components/ExerciseModal.jsx

import React, { useEffect, useCallback } from 'react';
import { useTheme } from '../context/ThemeContext';

function ExerciseModal({ exercise, onClose, onEdit, onDelete, onAddToPlan }) {
  const { darkMode } = useTheme();

  const handleEscapeKey = useCallback((event) => {
    if (event.key === 'Escape') {
      onClose();
    }
  }, [onClose]);

  useEffect(() => {
    document.addEventListener('keydown', handleEscapeKey);
    return () => {
      document.removeEventListener('keydown', handleEscapeKey);
    };
  }, [handleEscapeKey]);

  const handleOverlayClick = (event) => {
    if (event.target === event.currentTarget) {
      onClose();
    }
  };

  if (!exercise) return null;

  const categoryColors = {
    Strength: 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300',
    Cardio: 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300',
    Flexibility: 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300'
  };

  return (
    <div 
      className="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center z-50"
      onClick={handleOverlayClick}
    >
      <div 
        className="relative bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-4xl lg:max-w-6xl xl:max-w-7xl mx-4 p-6 lg:p-8 flex flex-col"
        onClick={(e) => e.stopPropagation()}
      >
        <button
          onClick={onClose}
          className="absolute top-4 right-4 text-gray-500 hover:text-gray-700 dark:text-gray-300 dark:hover:text-gray-100"
        >
          <svg className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
        <div className="flex-grow overflow-y-auto">
          <div className="flex flex-col lg:flex-row">
            <div className="lg:w-1/2 pr-0 lg:pr-8 mb-6 lg:mb-0">
              <img 
                src={exercise.imageUrl} 
                alt={exercise.name} 
                className="w-full h-64 md:h-96 lg:h-[500px] object-cover rounded-lg"
              />
            </div>
            <div className="lg:w-1/2 pl-0 lg:pl-8">
              <div className="flex justify-between items-center mb-4">
                <h3 className="text-3xl lg:text-4xl font-bold text-gray-900 dark:text-gray-100">{exercise.name}</h3>
                <span className={`px-3 py-1 text-sm font-semibold rounded-full ${categoryColors[exercise.category] || 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300'}`}>
                  {exercise.category}
                </span>
              </div>
              <p className="text-gray-700 dark:text-gray-300 mb-6 text-lg lg:text-xl">{exercise.description}</p>
              <p className="text-gray-600 dark:text-gray-400 mb-8 text-lg lg:text-xl">
                Target: {Array.isArray(exercise.target) ? exercise.target.join(', ') : exercise.target}
              </p>
            </div>
          </div>
        </div>
        <div className="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200 dark:border-gray-700">
          <button 
            onClick={() => onEdit(exercise)}
            className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded text-sm"
          >
            Edit
          </button>
          <button 
            onClick={() => onDelete(exercise)}
            className="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded text-sm"
          >
            Delete
          </button>
          <button 
            onClick={() => onAddToPlan(exercise)}
            className="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded text-sm"
          >
            Add to Plan
          </button>
        </div>
      </div>
    </div>
  );
}

export default ExerciseModal;
```

# src/components/ExerciseItem.jsx

```jsx
// src/components/ExerciseItem.jsx

import React, { useState } from 'react';
import { FiEdit, FiTrash2, FiPlus } from 'react-icons/fi';

function ExerciseItem({ exercise, onClick, onEdit, onDelete, onAddToPlan, viewMode }) {
  const [isDeleteConfirmOpen, setIsDeleteConfirmOpen] = useState(false);

  const handleAction = (action, e) => {
    e.stopPropagation();
    if (action === onDelete) {
      setIsDeleteConfirmOpen(true);
    } else {
      action(exercise);
    }
  };

  const confirmDelete = (e) => {
    e.stopPropagation();
    onDelete(exercise);
    setIsDeleteConfirmOpen(false);
  };

  const cancelDelete = (e) => {
    e.stopPropagation();
    setIsDeleteConfirmOpen(false);
  };

  const categoryColors = {
    Strength: 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300',
    Cardio: 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300',
    Flexibility: 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300'
  };

  const buttonStyles = {
    base: 'text-xs font-semibold py-1 px-2 rounded transition-all duration-200 flex items-center justify-center',
    edit: 'bg-indigo-500 text-white hover:bg-indigo-600 dark:bg-indigo-600 dark:hover:bg-indigo-700 hover:shadow-md',
    delete: 'bg-rose-500 text-white hover:bg-rose-600 dark:bg-rose-600 dark:hover:bg-rose-700 hover:shadow-md',
    addToPlan: 'bg-emerald-500 text-white hover:bg-emerald-600 dark:bg-emerald-600 dark:hover:bg-emerald-700 hover:shadow-md'
  };

  const CategoryBadge = () => (
    <span className={`px-2 py-1 text-xs font-semibold rounded-full ${categoryColors[exercise.category] || 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300'}`}>
      {exercise.category}
    </span>
  );

  const ActionButton = ({ action, style, icon, text }) => (
    <button 
      onClick={(e) => handleAction(action, e)}
      className={`${buttonStyles.base} ${style}`}
    >
      <span className="mr-1">{icon}</span>
      {text}
    </button>
  );

  const DeleteConfirmation = () => (
    <div className="absolute inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center rounded-lg">
      <div className="bg-white dark:bg-gray-700 p-4 rounded-lg text-center">
        <p className="mb-4 text-sm">Are you sure you want to delete this exercise?</p>
        <div className="flex justify-center space-x-2">
          <button onClick={confirmDelete} className={`${buttonStyles.base} ${buttonStyles.delete}`}>Yes, Delete</button>
          <button onClick={cancelDelete} className={`${buttonStyles.base} bg-gray-300 text-gray-800 hover:bg-gray-400`}>Cancel</button>
        </div>
      </div>
    </div>
  );

  const Content = () => (
    <>
      <div className="flex justify-between items-center mb-2">
        <h3 className="font-heading text-xl font-bold text-primary dark:text-blue-400">{exercise.name}</h3>
        <CategoryBadge />
      </div>
      <p className="text-gray-700 dark:text-gray-300 text-sm mb-2 line-clamp-2">{exercise.description}</p>
      <p className="text-accent dark:text-yellow-300 text-xs mb-4">
        Target: {Array.isArray(exercise.target) ? exercise.target.join(', ') : exercise.target}
      </p>
      <div className="flex justify-between mt-4">
        <ActionButton action={onEdit} style={buttonStyles.edit} icon={<FiEdit />} text="Edit" />
        <ActionButton action={onDelete} style={buttonStyles.delete} icon={<FiTrash2 />} text="Delete" />
        <ActionButton action={onAddToPlan} style={buttonStyles.addToPlan} icon={<FiPlus />} text="Add to Plan" />
      </div>
    </>
  );

  if (viewMode === 'list') {
    return (
      <div 
        className="relative bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden transition-transform duration-300 hover:scale-105 cursor-pointer flex items-center"
        onClick={() => onClick(exercise)}
      >
        <img 
          src={exercise.imageUrl} 
          alt={exercise.name} 
          className="w-24 h-24 object-cover"
        />
        <div className="flex-grow p-4">
          <Content />
        </div>
        {isDeleteConfirmOpen && <DeleteConfirmation />}
      </div>
    );
  }

  return (
    <div 
      className="relative bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden transition-transform duration-300 hover:scale-105 cursor-pointer"
      onClick={() => onClick(exercise)}
    >
      <img 
        src={exercise.imageUrl} 
        alt={exercise.name} 
        className="w-full h-48 object-cover"
      />
      <div className="p-4">
        <Content />
      </div>
      {isDeleteConfirmOpen && <DeleteConfirmation />}
    </div>
  );
}

export default ExerciseItem;
```

# src/components/Dashboard.jsx

```jsx
// src/components/Dashboard.jsx

import React, { useState, useEffect } from 'react';
import { useGymContext } from '../context/GymContext';
import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, BarChart, Bar, PieChart, Pie, Cell } from 'recharts';

function Dashboard() {
  const { workoutHistory } = useGymContext();
  const [totalWorkouts, setTotalWorkouts] = useState(0);
  const [averageWorkoutDuration, setAverageWorkoutDuration] = useState(0);
  const [workoutFrequencyData, setWorkoutFrequencyData] = useState([]);
  const [exerciseFrequencyData, setExerciseFrequencyData] = useState([]);
  const [workoutTypeData, setWorkoutTypeData] = useState([]);

  useEffect(() => {
    if (workoutHistory.length > 0) {
      // Calculate total workouts
      setTotalWorkouts(workoutHistory.length);

      // Calculate average workout duration
      const totalDuration = workoutHistory.reduce((sum, workout) => {
        const duration = new Date(workout.endTime) - new Date(workout.startTime);
        return sum + duration;
      }, 0);
      setAverageWorkoutDuration(totalDuration / workoutHistory.length / (1000 * 60)); // Convert to minutes

      // Prepare data for workout frequency chart
      const frequencyMap = {};
      workoutHistory.forEach(workout => {
        const date = new Date(workout.startTime).toLocaleDateString();
        frequencyMap[date] = (frequencyMap[date] || 0) + 1;
      });
      const frequencyData = Object.entries(frequencyMap).map(([date, count]) => ({ date, count }));
      setWorkoutFrequencyData(frequencyData);

      // Prepare data for exercise frequency chart
      const exerciseMap = {};
      workoutHistory.forEach(workout => {
        workout.exercises.forEach(exercise => {
          const exerciseName = exercise.exercise ? exercise.exercise.name : 'Unknown';
          exerciseMap[exerciseName] = (exerciseMap[exerciseName] || 0) + 1;
        });
      });
      const exerciseData = Object.entries(exerciseMap)
        .map(([name, count]) => ({ name, count }))
        .sort((a, b) => b.count - a.count)
        .slice(0, 10); // Top 10 exercises
      setExerciseFrequencyData(exerciseData);
    }

      // Calculate workout types
    const typeCount = {};
    workoutHistory.forEach(workout => {
      const type = workout.plan ? workout.plan.type : 'other';
      typeCount[type] = (typeCount[type] || 0) + 1;
    });
    const typeData = Object.entries(typeCount).map(([name, value]) => ({ name, value }));
    setWorkoutTypeData(typeData);

  }, [workoutHistory]);

  const COLORS = ['#0088FE', '#00C49F', '#FFBB28', '#FF8042'];

  return (
    <div className="p-4 bg-background">
      <h2 className="text-3xl font-heading font-bold mb-6 text-primary">Workout Dashboard</h2>
      <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
        <div className="bg-white p-4 rounded-lg shadow-md">
          <h3 className="text-xl font-semibold mb-2 text-text">Total Workouts</h3>
          <p className="text-4xl font-bold text-primary">{totalWorkouts}</p>
        </div>
        <div className="bg-white p-4 rounded-lg shadow-md">
          <h3 className="text-xl font-semibold mb-2 text-text">Average Workout Duration</h3>
          <p className="text-4xl font-bold text-primary">{averageWorkoutDuration.toFixed(1)} minutes</p>
        </div>
      </div>
      <div className="mb-8">
        <h3 className="text-2xl font-semibold mb-4 text-text">Workout Frequency</h3>
        <ResponsiveContainer width="100%" height={300}>
          <LineChart data={workoutFrequencyData}>
            <CartesianGrid strokeDasharray="3 3" />
            <XAxis dataKey="date" />
            <YAxis allowDecimals={false} domain={[0, 'dataMax + 1']} />
            <Tooltip />
            <Legend />
            <Line type="monotone" dataKey="count" stroke="#8884d8" activeDot={{ r: 8 }} />
          </LineChart>
        </ResponsiveContainer>
      </div>
      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <h3 className="text-2xl font-semibold mb-4 text-text">Top 10 Exercises</h3>
          <ResponsiveContainer width="100%" height={300}>
            <BarChart data={exerciseFrequencyData}>
              <CartesianGrid strokeDasharray="3 3" />
              <XAxis dataKey="name" />
              <YAxis allowDecimals={false} />
              <Tooltip />
              <Legend />
              <Bar dataKey="count" fill="#82ca9d" />
            </BarChart>
          </ResponsiveContainer>
        </div>
        <div>
          <h3 className="text-2xl font-semibold mb-4 text-text">Workout Types</h3>
          <ResponsiveContainer width="100%" height={300}>
            <PieChart>
              <Pie
                data={workoutTypeData}
                cx="50%"
                cy="50%"
                labelLine={false}
                outerRadius={80}
                fill="#8884d8"
                dataKey="value"
                label={({ name, percent }) => `${name} ${(percent * 100).toFixed(0)}%`}
              >
                {workoutTypeData.map((entry, index) => (
                  <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />
                ))}
              </Pie>
              <Tooltip />
            </PieChart>
          </ResponsiveContainer>
        </div>
      </div>
    </div>
  );
}

export default Dashboard;
```

# src/components/AddExerciseForm.jsx

```jsx
// src/components/AddExerciseForm.jsx

import { useState, useEffect } from 'react';
import { useGymContext } from '../context/GymContext';
import { useNotification } from '../context/NotificationContext';

const muscleGroups = [
  'Chest', 'Back', 'Shoulders', 'Biceps', 'Triceps', 'Legs', 'Core', 'Full Body', 'Abs'
];

const categories = ['Strength', 'Cardio', 'Flexibility'];

function AddExerciseForm({ onSave, initialExercise, onCancel }) {
  const [name, setName] = useState('');
  const [description, setDescription] = useState('');
  const [target, setTarget] = useState([]);
  const [imageUrl, setImageUrl] = useState('');
  const [category, setCategory] = useState('');
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [isExpanded, setIsExpanded] = useState(false);
  const { addExercise, updateExercise } = useGymContext();
  const { addNotification } = useNotification();

  useEffect(() => {
    if (initialExercise) {
      setName(initialExercise.name);
      setDescription(initialExercise.description);
      setTarget(Array.isArray(initialExercise.target) ? initialExercise.target : [initialExercise.target]);
      setImageUrl(initialExercise.imageUrl);
      setCategory(initialExercise.category || '');
      setIsExpanded(true);
    } else {
      setName('');
      setDescription('');
      setTarget([]);
      setImageUrl('');
      setCategory('');
    }
  }, [initialExercise]);

  const handleSubmit = async (e) => {
    e.preventDefault();
    if (isSubmitting) return;
    setIsSubmitting(true);

    if (target.length === 0) {
      addNotification('Please select at least one target muscle group', 'error');
      setIsSubmitting(false);
      return;
    }

    if (!category) {
      addNotification('Please select a category', 'error');
      setIsSubmitting(false);
      return;
    }

    const exercise = { name, description, target, imageUrl, category };
    try {
      let savedExercise;
      if (initialExercise) {
        savedExercise = await updateExercise(initialExercise._id, exercise);
        addNotification('Exercise updated successfully', 'success');
      } else {
        savedExercise = await addExercise(exercise);
        addNotification('Exercise added successfully', 'success');
      }
      setName('');
      setDescription('');
      setTarget([]);
      setImageUrl('');
      setCategory('');
      setIsExpanded(false);
      onSave(savedExercise);
    } catch (error) {
      addNotification('Failed to save exercise. Please try again.', 'error');
    } finally {
      setIsSubmitting(false);
    }
  };

  const handleTargetChange = (group) => {
    setTarget(prev => 
      prev.includes(group) 
        ? prev.filter(item => item !== group)
        : [...prev, group]
    );
  };

  const handleCancel = () => {
    setName('');
    setDescription('');
    setTarget([]);
    setImageUrl('');
    setCategory('');
    setIsExpanded(false);
    if (typeof onCancel === 'function') {
      onCancel();
    }
  };

  const toggleForm = () => {
    setIsExpanded(!isExpanded);
    if (!isExpanded) {
      setName('');
      setDescription('');
      setTarget([]);
      setImageUrl('');
      setCategory('');
    }
  };

  return (
    <div className="mb-8">
      <button
        onClick={toggleForm}
        className="mb-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"
      >
        {isExpanded ? 'Hide Form' : 'Add New Exercise'}
      </button>
      {isExpanded && (
        <form onSubmit={handleSubmit} className="bg-white dark:bg-gray-800 shadow-md rounded px-8 pt-6 pb-8 mb-4">
          <h2 className="text-2xl font-bold mb-4 text-gray-800 dark:text-white">
            {initialExercise ? 'Edit Exercise' : 'Add New Exercise'}
          </h2>
          <div className="mb-4">
            <label className="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2" htmlFor="name">
              Exercise Name
            </label>
            <input
              className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white leading-tight focus:outline-none focus:shadow-outline dark:bg-gray-700 dark:border-gray-600"
              id="name"
              type="text"
              placeholder="Exercise Name"
              value={name}
              onChange={(e) => setName(e.target.value)}
              required
            />
          </div>
          <div className="mb-4">
            <label className="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2" htmlFor="description">
              Description
            </label>
            <textarea
              className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white leading-tight focus:outline-none focus:shadow-outline dark:bg-gray-700 dark:border-gray-600"
              id="description"
              placeholder="Exercise Description"
              value={description}
              onChange={(e) => setDescription(e.target.value)}
              required
            />
          </div>
          <div className="mb-4">
            <label className="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">
              Target Muscle Groups
            </label>
            <div className="flex flex-wrap -mx-1">
              {muscleGroups.map(group => (
                <div key={group} className="px-1 mb-2">
                  <button
                    type="button"
                    onClick={() => handleTargetChange(group)}
                    className={`py-1 px-2 rounded ${
                      target.includes(group)
                        ? 'bg-blue-500 text-white'
                        : 'bg-gray-200 text-gray-700 dark:bg-gray-600 dark:text-gray-300'
                    }`}
                  >
                    {group}
                  </button>
                </div>
              ))}
            </div>
          </div>
          <div className="mb-4">
            <label className="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2" htmlFor="category">
              Category
            </label>
            <select
              className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white leading-tight focus:outline-none focus:shadow-outline dark:bg-gray-700 dark:border-gray-600"
              id="category"
              value={category}
              onChange={(e) => setCategory(e.target.value)}
              required
            >
              <option value="">Select a category</option>
              {categories.map(cat => (
                <option key={cat} value={cat}>{cat}</option>
              ))}
            </select>
          </div>
          <div className="mb-4">
            <label className="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2" htmlFor="imageUrl">
              Image URL
            </label>
            <input
              className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white leading-tight focus:outline-none focus:shadow-outline dark:bg-gray-700 dark:border-gray-600"
              id="imageUrl"
              type="text"
              placeholder="Image URL"
              value={imageUrl}
              onChange={(e) => setImageUrl(e.target.value)}
            />
          </div>
          <div className="flex items-center justify-between">
            <button
              className={`bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline ${isSubmitting ? 'opacity-50 cursor-not-allowed' : ''}`}
              type="submit"
              disabled={isSubmitting}
            >
              {isSubmitting ? 'Saving...' : (initialExercise ? 'Update Exercise' : 'Add Exercise')}
            </button>
            <button
              className="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
              type="button"
              onClick={handleCancel}
            >
              Cancel
            </button>
          </div>
        </form>
      )}
    </div>
  );
}

export default AddExerciseForm;
```

# src/assets/react.svg

This is a file of the type: SVG Image

